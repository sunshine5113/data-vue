import{d as e,e as a,L as l,H as t,aF as i,ai as s,I as n,M as o,aG as r,au as c,P as d,Q as p,f as u,o as m,c as v,a as f,F as g,g as w,t as b,R as C,z as k}from"./index.fbe2df72.js";import{P as h}from"./project.ec6ffcb1.js";const y=window.requestAnimationFrame||(e=>setTimeout(e,16));function V(e,a={}){const{getContainer:l=(()=>window),callback:t,duration:i=450}=a,s=l(),n=function(e,a){if("undefined"==typeof window)return 0;const l=a?"scrollTop":"scrollLeft",t=e===window;let i=t?e[a?"pageYOffset":"pageXOffset"]:e[l];return t&&"number"!=typeof i&&(i=window.document.documentElement[l]),i}(s,!1),o=Date.now(),r=()=>{const a=Date.now()-o,l=function(e,a,l,t){const i=l-a;return(e/=t/2)<1?i/2*e*e*e+a:i/2*((e-=2)*e*e+2)+a}(a>i?i:a,n,e,i);s===window?window.scrollTo(l,window.pageYOffset):s.scrollLeft=l,a<i?y(r):"function"==typeof t&&t()};y(r)}var _=e({name:"CreateScreen",setup(){const e=a(!0),d=a(c.logo),p=a([]),u=a(!1),m=a(!1),v=a(""),f=a({}),g=a(0),w=a([new h(0,"未分组")]),b=a(!1),C=l(),k=a(null);t((async()=>{const a=await i();0===a.data.code&&(e.value=!1,p.value=a.data.data),s().then((({data:e})=>{0===e.code&&w.value.push(...e.data.map((({id:e,name:a})=>({id:e,name:a}))))}))}));const y=(e,a)=>{f.value=e,V(149*a-350,{getContainer:()=>k.value})};return{loading:e,bgCoverImg:d,templates:p,visibleCreateDialog:u,visiblePreviewDialog:m,projectName:v,template:f,groupId:g,groups:w,saveLoading:b,scrollRef:k,confirmCreate:e=>{f.value=e,u.value=!0},previewTemplate:(e,a)=>{f.value=e,m.value=!0,n((()=>{y(e,a)}))},togglePreviewTemplate:y,prevPreviewTemplate:()=>{const e=p.value.findIndex((e=>e.id===f.value.id));if(e>0){const a=e-1,l=p.value[a];y(l,a)}},nextPreviewTemplate:()=>{const e=p.value.findIndex((e=>e.id===f.value.id));if(e<p.value.length-1){const a=e+1,l=p.value[a];y(l,a)}},doCreate:async()=>{var e,a;try{if(!v.value)return void o.error("请输入大屏名称");b.value=!0;const l=await r({name:v.value,groupId:g.value,templateId:null!=(a=null==(e=f.value)?void 0:e.id)?a:0});if(0!==l.data.code)throw Error(l.data.message);u.value=!1,m.value=!1,C.push({name:"ScreenEditor",params:{projectId:l.data.data}})}catch(l){o.error(o.format(l))}finally{b.value=!1}}}}});const I=C();d("data-v-e4b9184c");const P={class:"create-screen"},T={class:"top-bar"},x=f("div",{class:"right-bar"},null,-1),j=f("div",{class:"left-bar"},null,-1),D=f("span",{class:"return-text"},[f("i",{class:"v-icon-back return-icon"}),k(" 取消创建 ")],-1),z={class:"creator-wp"},L={class:"template-list"},U={class:"template-item --blank"},N={class:"template-image"},q=k(" 创建项目 "),E=f("div",{class:"template-info"}," 空白画板 ",-1),F={class:"template-image"},O={class:"template-mask"},R=k(" 创建项目 "),S=k(" 预览 "),Y={class:"template-info"},A={class:"template-name"},G={class:"template-size"},H={class:"create-dialog"},M=f("p",{class:"name-title"},[f("span",{class:"required"},"*"),k("数据大屏名称 ")],-1),Q=f("p",{class:"name-title"},"大屏分组",-1),X=k("取消"),B=k(" 创建 "),J={class:"preview-dialog"},K={class:"preview-list"},W=f("p",{class:"template-list-title"},"模板列表",-1),Z={class:"blur-wp"},$={ref:"scrollRef",class:"scroll-wp"},ee={class:"preview-screen-name"},ae={class:"preview-gif"},le={class:"gif-wp"},te={class:"preview-create"},ie={class:"create-dialog"},se=f("p",{class:"name-title"},[f("span",{class:"required"},"*"),k("数据大屏名称 ")],-1),ne=f("p",{class:"name-title"},"大屏分组",-1),oe=k(" 创建大屏 "),re=f("i",{class:"v-icon-arrow-right next-icon"},null,-1);p();const ce=I(((e,a,l,t,i,s)=>{const n=u("router-link"),o=u("el-button"),r=u("g-loading"),c=u("new-input"),d=u("el-option"),p=u("el-select"),C=u("el-dialog");return m(),v(g,null,[f(r,{type:"square",spinning:e.loading},{default:I((()=>[f("div",P,[f("div",T,[x,j,f(n,{to:"/",class:"return-btn"},{default:I((()=>[D])),_:1})]),f("div",z,[f("div",L,[f("div",U,[f("div",N,[f(o,{type:"primary",icon:"v-icon-plus",onClick:a[1]||(a[1]=a=>e.confirmCreate(null))},{default:I((()=>[q])),_:1})]),E]),(m(!0),v(g,null,w(e.templates,((a,l)=>(m(),v("div",{key:a.id,class:"template-item"},[f("div",F,[f("img",{src:a.thumbnail,alt:"",class:"preview-image"},null,8,["src"]),f("div",O,[f(o,{type:"primary",class:"create-btn",onClick:l=>e.confirmCreate(a)},{default:I((()=>[R])),_:2},1032,["onClick"]),f(o,{class:"preview-btn",onClick:t=>e.previewTemplate(a,l)},{default:I((()=>[S])),_:2},1032,["onClick"])])]),f("div",Y,[f("div",A,b(a.name),1),f("div",G,[(m(!0),v(g,null,w(a.size,((e,a)=>(m(),v("p",{key:a},b(e),1)))),128))])])])))),128)),(m(),v(g,null,w(3,(e=>f("div",{key:e,class:"template-item-placehoder"}))),64))])])])])),_:1},8,["spinning"]),f(C,{modelValue:e.visibleCreateDialog,"onUpdate:modelValue":a[5]||(a[5]=a=>e.visibleCreateDialog=a),title:"创建数据大屏",width:"400px"},{footer:I((()=>[f(o,{onClick:a[4]||(a[4]=a=>e.visibleCreateDialog=!1)},{default:I((()=>[X])),_:1}),f(o,{type:"primary",loading:e.saveLoading,onClick:e.doCreate},{default:I((()=>[B])),_:1},8,["loading","onClick"])])),default:I((()=>[f("div",H,[M,f(c,{modelValue:e.projectName,"onUpdate:modelValue":a[2]||(a[2]=a=>e.projectName=a),placeholder:"请输入大屏名称",spellcheck:"false",class:"name-input"},null,8,["modelValue"]),Q,f(p,{modelValue:e.groupId,"onUpdate:modelValue":a[3]||(a[3]=a=>e.groupId=a),size:"mini",placeholder:"请选择"},{default:I((()=>[(m(!0),v(g,null,w(e.groups,(e=>(m(),v(d,{key:e.id,label:e.name,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])])),_:1},8,["modelValue"]),f(C,{modelValue:e.visiblePreviewDialog,"onUpdate:modelValue":a[10]||(a[10]=a=>e.visiblePreviewDialog=a),title:"预览",width:"897px"},{default:I((()=>[f("div",J,[f("div",K,[W,f("div",Z,[f("div",$,[(m(!0),v(g,null,w(e.templates,((a,l)=>(m(),v("div",{key:a.id,class:["preview-wp",{selected:a.id===e.template.id}],onClick:t=>e.togglePreviewTemplate(a,l)},[f("img",{src:a.thumbnail,class:"preview-small-img"},null,8,["src"]),f("div",ee,b(a.name),1)],10,["onClick"])))),128))],512)])]),f("div",ae,[f("div",le,[f("img",{class:"snapshot-gif",src:e.template.snapshot},null,8,["src"]),f("i",{class:"v-icon-arrow-left prev-icon",onClick:a[6]||(a[6]=(...a)=>e.prevPreviewTemplate&&e.prevPreviewTemplate(...a))}),f("i",{class:"v-icon-arrow-right next-icon",onClick:a[7]||(a[7]=(...a)=>e.nextPreviewTemplate&&e.nextPreviewTemplate(...a))})]),f("div",te,[f("div",ie,[se,f(c,{modelValue:e.projectName,"onUpdate:modelValue":a[8]||(a[8]=a=>e.projectName=a),placeholder:"请输入大屏名称",spellcheck:"false",class:"name-input"},null,8,["modelValue"]),ne,f(p,{modelValue:e.groupId,"onUpdate:modelValue":a[9]||(a[9]=a=>e.groupId=a),size:"mini",placeholder:"请选择"},{default:I((()=>[(m(!0),v(g,null,w(e.groups,(e=>(m(),v(d,{key:e.id,label:e.name,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])]),f(o,{type:"primary",size:"mini",loading:e.saveLoading,class:"preview-create-btn",onClick:e.doCreate},{default:I((()=>[oe,re])),_:1},8,["loading","onClick"])])])])])),_:1},8,["modelValue"])],64)}));_.render=ce,_.__scopeId="data-v-e4b9184c";export default _;
