import{d as a,e,j as s,k as l,L as o,O as d,M as t,ax as r,ay as i,az as c,C as n,D as u,f as p,n as v,o as h,c as b,q as m,a as w,t as y,B as f,G as g}from"./index.8db3acde.js";import{U as V}from"./constants.0fbfcb4e.js";var U=a({name:"PublishScreen",props:{projectId:{type:Number,required:!0},modelValue:{type:Boolean,required:!0}},emits:[V],setup(a,n){const u=e(!1),p=e(!1),v=e(!1),h=e(""),b=e("password"),m=e(!0),w=s((()=>p.value?i(a.projectId):"")),y=()=>{u.value=!1,n.emit(V,!1)};l((()=>a.modelValue),(a=>{u.value=!!a})),l((()=>a.projectId),(async()=>{try{const e=await c(a.projectId);if(0===e.data.code){const{data:a}=e.data;m.value=!1,p.value=!!a.share,h.value=a.password}}catch(e){t.error("读取大屏发布信息失败")}}));return{visible:u,isPublish:p,shareUrl:w,showTooltip:v,password:h,copyUrl:()=>{p.value&&o((()=>{d(w.value)&&t.success("复制成功")}))},closeDialog:y,loading:m,passwordType:b,publish:async()=>{try{m.value=!0;const e={share:w.value,password:h.value};0===(await r(a.projectId,e)).data.code&&(m.value=!1,y(),t.success(p.value?"发布成功":"保存成功"))}catch(e){t.error("发布失败")}finally{m.value=!1}}}}});const k=g();n("data-v-fdf26c62");const T={class:"share-setting","element-loading-background":"rgba(48, 54, 64, 0.8)"},C={class:"share-header"},j={class:"header-wp"},_=w("label",{class:"label-color"},"发布分享：",-1),I={class:"share-switch"},P={class:"share-tutorial"},x=f(" 查看教程 "),M={class:"share-verify"},q=w("div",{class:"label-color"},"分享链接",-1),D={class:"link-content"},B=w("div",{class:"label-color"},"访问密码",-1),z={class:"share-pwd"},G={class:"initial-dialog"};u();const L=k(((a,e,s,l,o,d)=>{const t=p("el-switch"),r=p("router-link"),i=p("el-tooltip"),c=p("g-input"),n=p("el-button"),u=p("el-dialog"),g=v("loading");return h(),b(u,{modelValue:a.visible,"onUpdate:modelValue":e[10]||(e[10]=e=>a.visible=e),title:"发布",width:"435px","append-to-body":!0,onClose:a.closeDialog},{default:k((()=>[m(w("div",T,[w("div",C,[w("div",j,[_,w("div",I,[w(t,{modelValue:a.isPublish,"onUpdate:modelValue":e[1]||(e[1]=e=>a.isPublish=e)},null,8,["modelValue"])])]),w("div",P,[w(r,{to:{name:"MyCase"},class:"share-tutorial-url",target:"_blank"},{default:k((()=>[x])),_:1})])]),w("div",M,[q,w("div",D,[w(i,{modelValue:a.showTooltip,"onUpdate:modelValue":e[5]||(e[5]=e=>a.showTooltip=e),effect:"blue",placement:"top",content:"点击复制",manual:!0,disabled:!a.isPublish},{default:k((()=>[w("textarea",{value:a.shareUrl,class:"g-input share-input",readonly:"",placeholder:"开启发布分享后可获取访问链接",onClick:e[2]||(e[2]=(...e)=>a.copyUrl&&a.copyUrl(...e)),onMouseenter:e[3]||(e[3]=e=>a.showTooltip=!0),onMouseleave:e[4]||(e[4]=e=>a.showTooltip=!1)},null,40,["value"])])),_:1},8,["modelValue","disabled"]),w("div",{class:"func-btn",onClick:e[6]||(e[6]=(...e)=>a.copyUrl&&a.copyUrl(...e))},"复制")]),B,w("div",z,[w(c,{modelValue:a.password,"onUpdate:modelValue":e[7]||(e[7]=e=>a.password=e),type:a.passwordType,placeholder:"设置访问密码",class:"pwd-input"},null,8,["modelValue","type"]),w("div",{class:"func-btn",onClick:e[8]||(e[8]=e=>a.passwordType?a.passwordType="":a.passwordType="password")},y(a.passwordType?"查看":"隐藏"),1),w("div",{class:"func-btn",onClick:e[9]||(e[9]=e=>a.password="")}," 清空 ")])]),w("div",G,[w(n,{type:"primary",class:"publish-btn",onClick:a.publish},{default:k((()=>[f(y(a.isPublish?"发布大屏":"保存"),1)])),_:1},8,["onClick"])])],512),[[g,a.loading]])])),_:1},8,["modelValue","onClose"])}));U.render=L,U.__scopeId="data-v-fdf26c62";export{U as _};
