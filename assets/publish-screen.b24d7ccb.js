import{d as a,ap as e,r as s,e as l,w as o,n as d,aq as t,M as r,ar as i,j as c,as as p,y as u,z as n,k as v,ak as h,l as b,m as w,ag as y,p as m,v as f,t as g,A as V}from"./index.96b29a26.js";var k=a({name:"PublishScreen",props:{projectId:{type:Number,required:!0},modelValue:{type:Boolean,required:!0}},emits:[e],setup(a,u){const n=s(!1),v=s(!1),h=s(!1),b=s(""),w=s("password"),y=s(!0),m=l((()=>v.value?i(a.projectId):"")),f=()=>{n.value=!1,u.emit(e,!1)};o((()=>a.modelValue),(a=>{n.value=!!a})),o((()=>a.projectId),(async()=>{try{const e=await p(a.projectId);if(0===e.data.code){const{data:a}=e.data;y.value=!1,v.value=!!a.share,b.value=a.password}}catch(e){r.error("读取大屏发布信息失败")}}));return{visible:n,isPublish:v,shareUrl:m,showTooltip:h,password:b,copyUrl:()=>{v.value&&d((()=>{c(m.value)&&r.success("复制成功")}))},closeDialog:f,loading:y,passwordType:w,publish:async()=>{try{y.value=!0;const e={share:m.value,password:b.value};0===(await t(a.projectId,e)).data.code&&(y.value=!1,f(),r.success(v.value?"发布成功":"保存成功"))}catch(e){r.error("发布失败")}finally{y.value=!1}}}}});const T=V();u("data-v-fdf26c62");const U={class:"share-setting","element-loading-background":"rgba(48, 54, 64, 0.8)"},C={class:"share-header"},_={class:"header-wp"},j=m("label",{class:"label-color"},"发布分享：",-1),I={class:"share-switch"},P={class:"share-tutorial"},x=g(" 查看教程 "),M={class:"share-verify"},q=m("div",{class:"label-color"},"分享链接",-1),D={class:"link-content"},z=m("div",{class:"label-color"},"访问密码",-1),A={class:"share-pwd"},B={class:"initial-dialog"};n();const N=T(((a,e,s,l,o,d)=>{const t=v("el-switch"),r=v("router-link"),i=v("el-tooltip"),c=v("g-input"),p=v("el-button"),u=v("el-dialog"),n=h("loading");return b(),w(u,{modelValue:a.visible,"onUpdate:modelValue":e[10]||(e[10]=e=>a.visible=e),title:"发布",width:"435px","append-to-body":!0,onClose:a.closeDialog},{default:T((()=>[y(m("div",U,[m("div",C,[m("div",_,[j,m("div",I,[m(t,{modelValue:a.isPublish,"onUpdate:modelValue":e[1]||(e[1]=e=>a.isPublish=e)},null,8,["modelValue"])])]),m("div",P,[m(r,{to:{name:"MyCase"},class:"share-tutorial-url",target:"_blank"},{default:T((()=>[x])),_:1})])]),m("div",M,[q,m("div",D,[m(i,{modelValue:a.showTooltip,"onUpdate:modelValue":e[5]||(e[5]=e=>a.showTooltip=e),effect:"blue",placement:"top",content:"点击复制",manual:!0,disabled:!a.isPublish},{default:T((()=>[m("textarea",{value:a.shareUrl,class:"g-input share-input",readonly:"",placeholder:"开启发布分享后可获取访问链接",onClick:e[2]||(e[2]=(...e)=>a.copyUrl&&a.copyUrl(...e)),onMouseenter:e[3]||(e[3]=e=>a.showTooltip=!0),onMouseleave:e[4]||(e[4]=e=>a.showTooltip=!1)},null,40,["value"])])),_:1},8,["modelValue","disabled"]),m("div",{class:"func-btn",onClick:e[6]||(e[6]=(...e)=>a.copyUrl&&a.copyUrl(...e))},"复制")]),z,m("div",A,[m(c,{modelValue:a.password,"onUpdate:modelValue":e[7]||(e[7]=e=>a.password=e),type:a.passwordType,placeholder:"设置访问密码",class:"pwd-input"},null,8,["modelValue","type"]),m("div",{class:"func-btn",onClick:e[8]||(e[8]=e=>a.passwordType?a.passwordType="":a.passwordType="password")},f(a.passwordType?"查看":"隐藏"),1),m("div",{class:"func-btn",onClick:e[9]||(e[9]=e=>a.password="")}," 清空 ")])]),m("div",B,[m(p,{type:"primary",class:"publish-btn",onClick:a.publish},{default:T((()=>[g(f(a.isPublish?"发布大屏":"保存"),1)])),_:1},8,["onClick"])])],512),[[n,a.loading]])])),_:1},8,["modelValue","onClose"])}));k.render=N,k.__scopeId="data-v-fdf26c62";export{k as _};
