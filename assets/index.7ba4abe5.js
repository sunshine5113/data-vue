var ue=Object.defineProperty;var j=Object.getOwnPropertySymbols;var he=Object.prototype.hasOwnProperty,me=Object.prototype.propertyIsEnumerable;var O=(e,t,n)=>t in e?ue(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,T=(e,t)=>{for(var n in t||(t={}))he.call(t,n)&&O(e,n,t[n]);if(j)for(var n of j(t))me.call(t,n)&&O(e,n,t[n]);return e};var M=(e,t,n)=>(O(e,typeof t!="symbol"?t+"":t,n),n);import{a6 as w,aa as L,ad as v,a4 as G,aC as p,ac as y,ah as ee,a9 as S,aF as fe,aj as ve,ax as ge,a5 as R,aX as q,a$ as te,a7 as W,ag as U,ab as E,ai as ye,ae as N,af as ne,aN as I,bq as pe,ba as oe,bb as se,bj as J,n as we,bk as xe}from"./vendor.1c7e0fbb.js";import{a as k,x as V,w as ie,C as $e,y as Me}from"./AppRoot.9161bc33.js";import{c as Le}from"./index.2ec4af99.js";import{a as B,o as b,b as C}from"./dom.6d6c7f4f.js";import{u as be}from"./index.4d44cbc9.js";import"./templates.c8d0560b.js";const Ce={},_e={t:"1639130833808",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"3985",width:"64",height:"64"},Se=v("path",{d:"M341.33333333 579.33333333C426.66933333 463.33333333 511.99733333 405.33333333 597.33333333 405.33333333c85.336 0 170.664 58 256 174C767.99733333 676.66933333 682.66933333 725.33333333 597.33333333 725.33333333c-85.336 0-170.664-48.664-256-146z m96-5.6C490.66933333 632.13333333 543.99733333 661.33333333 597.33333333 661.33333333s106.664-29.2 160-87.6C703.99733333 504.13333333 650.66933333 469.33333333 597.33333333 469.33333333s-106.664 34.8-160 104.4zM597.33333333 629.33333333a64 64 0 1 1 0-128 64 64 0 0 1 0 128zM213.33333333 213.33333333V85.33333333h64v128h640v64H277.33333333v640h-64V277.33333333H85.33333333v-64h128z","p-id":"3986"},null,-1),Re=[Se];function ke(e,t){return w(),L("svg",_e,Re)}var ze=k(Ce,[["render",ke]]);const Te={},Ee={t:"1639130872871",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"4135",width:"64",height:"64"},Ie=v("path",{d:"M651.14133333 413.01333333l-56.344 56.344C542.30933333 470.45333333 489.82133333 505.23733333 437.33333333 573.73333333a416 416 0 0 0 26.48 26.6l-49.976 49.984c-24.168-19.76-48.336-43.416-72.504-70.984C426.66933333 463.33333333 511.99733333 405.33333333 597.33333333 405.33333333c17.936 0 35.872 2.56 53.808 7.68z m113.968 67.056c29.408 26.2 58.816 59.28 88.224 99.264C767.99733333 676.66933333 682.66933333 725.33333333 597.33333333 725.33333333c-22.456 0-44.92-3.368-67.376-10.112l54.456-54.456c4.304 0.376 8.616 0.568 12.92 0.568 53.336 0 106.664-29.2 160-87.6-13.368-17.44-26.736-32.704-40.112-45.784l47.888-47.88zM213.33333333 213.33333333V85.33333333h64v128h640v64H277.33333333v640h-64V277.33333333H85.33333333v-64h128z","p-id":"4136"},null,-1),Be=v("path",{d:"M770.34933333 339.06133333l45.256 45.256-407.288 407.288-45.256-45.256z","p-id":"4137"},null,-1),Xe=[Ie,Be];function De(e,t){return w(),L("svg",Ee,Xe)}var We=k(Te,[["render",De]]);const Ae=G({name:"AlignLine",setup(){const e=V();return{alignLine:p(()=>e.alignLine),canvas:p(()=>e.canvas)}}}),Ge={key:0,class:"ident-line-wp"};function Fe(e,t,n,i,o,s){return e.alignLine.enable&&e.alignLine.show?(w(),L("div",Ge,[v("div",{class:"ident-line x-line",style:y({width:`${e.canvas.width}px`,top:`${e.alignLine.top}px`})},null,4),v("div",{class:"ident-line x-line",style:y({width:`${e.canvas.width}px`,top:`${e.alignLine.horizontal}px`})},null,4),v("div",{class:"ident-line x-line",style:y({width:`${e.canvas.width}px`,top:`${e.alignLine.bottom}px`})},null,4),v("div",{class:"ident-line y-line",style:y({height:`${e.canvas.height}px`,left:`${e.alignLine.left}px`})},null,4),v("div",{class:"ident-line y-line",style:y({height:`${e.canvas.height}px`,left:`${e.alignLine.vertical}px`})},null,4),v("div",{class:"ident-line y-line",style:y({height:`${e.canvas.height}px`,left:`${e.alignLine.right}px`})},null,4)])):ee("",!0)}var Ye=k(Ae,[["render",Fe],["__scopeId","data-v-0f9e3b7f"]]);const A=e=>`${e}px`,K=(e,t,n,i)=>{const o=e!=null?e:document.createElement("canvas");o.width=t*i,o.height=n*i,o.style.width=A(t),o.style.height=A(n);const s=o.getContext("2d");return s&&s.setTransform(i,0,0,i,0,0),o},ae=(e,t,n,i)=>{var h,d;const o=parseFloat(e.style.transform.match(/(?<=X\()(.+)/ig)[0]),{height:s,scale:l,offset:c}=t;let a=0;return t.direction=="TB"?a=n-(((h=e.parentElement)==null?void 0:h.offsetLeft)||0)-o:a=i-(((d=e.parentElement)==null?void 0:d.offsetTop)||0)-o,a=a-s+t.indicatorLineWidth,{coor:Math.floor((a-c)/l),dist:a}},He=(e,t)=>{const{scale:n,offset:i}=t;return{coor:e,dist:parseFloat((e*n+i).toFixed(3))}},H=class{constructor(t,n,i,o=0){M(this,"guideLine");M(this,"coor",-1);this.el=t,this.options=n,this.constructGuide(i,o)}constructGuide(t,n){const{el:i}=this,o=document.createElement("div");o.title="\u53CC\u51FB\u5220\u9664\u53C2\u8003\u7EBF",B(o,"ruler-line"),this.guideLine=o;const{coor:s}=this;this.setLine(t,n),t&&this.coorChange("add",this.coor,s);let l=i.querySelector(".lines-wrapper");l||(l=document.createElement("div"),B(l,"lines-wrapper"),i.appendChild(l)),l.appendChild(o),b(o,"mousedown",this.moving.bind(this)),b(o,"dblclick",this.dblclick.bind(this))}moving(t){H.isMoveing=!0;const{options:n}=this;t.preventDefault(),t.stopPropagation();const{coor:i}=this,o=l=>{n.direction==="TB"?document.body.style.cursor="ew-resize":document.body.style.cursor="ns-resize",this.setLine(l)},s=()=>{H.isMoveing=!1,document.body.style.cursor="",C(document,"mousemove",o),C(document,"mouseup",s);const{coor:l}=this;l<0?this.coorChange("delete",i,i):this.coorChange("update",l,i)};b(document,"mousemove",o),b(document,"mouseup",s)}setLine(t,n=0){const{el:i,options:o,guideLine:s}=this,l=t?ae(i,o,t.clientX,t.clientY):He(n,o);o.direction==="TB"?s.style.left=A(l.dist):s.style.top=A(l.dist),s.innerHTML=`
      <div class="line-action">
        <span class="line-value">${l.coor}</span>
      </div>`,this.coor=l.coor}dblclick(t){t.preventDefault(),t.stopPropagation(),this.destroy()}coorChange(t,n,i){const{options:o}=this;o.coorChange&&o.coorChange(t,n,i)}show(){this.guideLine.style.display="block"}hide(){this.guideLine.style.display="none"}destroy(){const{guideLine:t,coor:n}=this;this.coorChange("delete",n,n),C(t,"mousedown",this.moving.bind(this)),C(t,"dblclick",this.dblclick.bind(this)),t.remove()}};let X=H;M(X,"isMoveing",!1);class Q{constructor(t,n){M(this,"el");M(this,"canvas");M(this,"ctx");M(this,"ruler",{width:0,height:0});M(this,"indicator");M(this,"indicatorValue");M(this,"guideLines",[]);M(this,"options",{direction:"TB",width:1e3,height:20,bgColor:"#0e1013",fontFamily:"sans-serif",fontSize:"10px",fontColor:"#90a0ae",strokeStyle:"rgba(161, 174, 179, 0.8)",lineWidth:.5,indicatorLineWidth:1,scale:1,offset:40,ratio:2});this.el=t,this.options=T(T({},this.options),n),this.constructRuler()}constructRuler(){const{el:t,options:n}=this,{direction:i,width:o,height:s,ratio:l}=n,c=Math.max(i==="TB"?t.offsetWidth:t.offsetHeight,o),a=s;this.ruler.width=c,this.ruler.height=a;const r=K(null,c,a,l);B(r,"canvas-ruler"),t.appendChild(r),this.canvas=r,this.ctx=r.getContext("2d"),this.drawRuler(),b(r,"mouseenter",this.constructIndicator.bind(this)),b(r,"mousedown",this.createGuideLine.bind(this))}drawRuler(){const{ctx:t,options:n,ruler:i}=this,{width:o,height:s}=i;t.beginPath(),t.fillStyle=n.bgColor,t.fillRect(0,0,o,s),t.closePath(),t.beginPath(),t.font=`${n.fontSize} ${n.fontFamily}`,t.textAlign="left",t.fillStyle=n.fontColor,t.strokeStyle=n.strokeStyle,t.lineWidth=n.lineWidth,this.drawPoints(),t.stroke()}drawPoints(){const{ctx:t,options:n,ruler:i}=this,{width:o,height:s}=i,{offset:l,scale:c}=n,a=0,r=s/1.5,h=s/1.2;for(let d=0;d<=o;d+=1){const u=d-l;if(u<0)continue;let g=-1,m=-1;u%50===0?(g=Math.floor(u/c),m=a):u%25===0?m=r:u%5===0&&(m=h),m>=0&&(t.moveTo(d+.5,s+.5),t.lineTo(d+.5,m),g>-1&&t.fillText(`${g}`,d+2.5,s/1.5))}}constructIndicator(t){if(X.isMoveing)return;const{el:n,options:i,canvas:o}=this,s=document.createElement("div"),l=document.createElement("span");B(s,"ruler-indicator"),B(l,"indicator-value"),s.appendChild(l),this.indicator=s,this.indicatorValue=l,n.appendChild(s);const c=h=>{const d=ae(n,i,h.clientX,h.clientY);s.style.left=A(d.dist),l.textContent=`${d.coor}`};c(t);const a=h=>{c(h)},r=()=>{C(o,"mousemove",a),C(o,"mouseout",r),s.remove()};b(o,"mousemove",a),b(o,"mouseout",r)}createGuideLine(t){t.preventDefault(),t.stopPropagation();const{el:n,options:i}=this;this.guideLines.push(new X(n,i,t))}setGuideLines(t){const{el:n,options:i}=this;t.forEach(o=>{this.guideLines.push(new X(n,i,null,o))})}setSize(t,n,i){const{el:o,options:s}=this;s.width=t,s.height=n,s.scale=i;const{direction:l,width:c,height:a,ratio:r}=s,h=Math.max(l==="TB"?o.offsetWidth:o.offsetHeight,c),d=a;this.ruler.width=h,this.ruler.height=d,K(this.canvas,h,d,r),this.drawRuler(),this.guideLines.forEach(u=>u.setLine(null,u.coor))}setScale(t){this.options.scale=t,this.drawRuler(),this.guideLines.forEach(n=>n.setLine(null,n.coor))}toggleGuide(t){const n=t?"show":"hide";this.guideLines.forEach(i=>i[n]())}clearGuides(){this.guideLines.forEach(t=>t.destroy()),this.guideLines=[]}destroy(){const{el:t,canvas:n}=this;this.clearGuides(),C(n,"mouseenter",this.constructIndicator.bind(this)),C(n,"mousedown",this.createGuideLine.bind(this)),t.remove()}}const Ve=G({name:"Ruler",components:{IconLineShow:ze,IconLineHide:We},setup(){const e=V(),t=S(null),n=S(null),i=S(null),o=S(null),s=S(!0),l=S(0),c=S(0),a=document.documentElement.clientWidth;fe(()=>{if(t.value&&n.value){const{canvas:d,guideLine:u}=e,g=Math.max(d.width,a);i.value?i.value.setSize(g,20,d.scale):(i.value=new Q(t.value,{direction:"TB",width:g,scale:d.scale,coorChange:(m,f,$)=>{m==="add"?u.h.push(f):m==="update"&&f!==$?(u.h=u.h.filter(_=>_!==$),u.h.push(f)):m==="delete"&&(u.h=u.h.filter(_=>_!==f))}}),i.value.setGuideLines(u.h)),o.value?o.value.setSize(d.height,20,d.scale):(o.value=new Q(n.value,{direction:"LR",width:d.height,scale:d.scale,coorChange:(m,f,$)=>{m==="add"?u.v.push(f):m==="update"&&f!==$?(u.v=u.v.filter(_=>_!==$),u.v.push(f)):m==="delete"&&(u.v=u.v.filter(_=>_!==f))}}),o.value.setGuideLines(u.v))}});const r=()=>{i.value&&o.value&&(s.value=!s.value,i.value.toggleGuide(s.value),o.value.toggleGuide(s.value))},h=d=>{const u=d.target;l.value=u.scrollLeft,c.value=u.scrollTop};return ve(()=>{const d=document.getElementById("canvas-wp");d==null||d.addEventListener("scroll",h)}),ge(()=>{const d=document.getElementById("canvas-wp");d==null||d.removeEventListener("scroll",h)}),{visible:s,hRulerWpRef:t,vRulerWpRef:n,toggleGuides:r,vScroll:c,hScroll:l}}}),Oe={class:"canvas-ruler-wp"};function qe(e,t,n,i,o,s){const l=R("IconLineShow"),c=R("IconLineHide"),a=R("n-icon");return w(),L("div",Oe,[v("div",{ref:"hRulerWpRef",class:"ruler-wrapper h-container",style:y(`transform: translateX(-${e.hScroll}px);`)},null,4),v("div",{ref:"vRulerWpRef",class:"ruler-wrapper v-container",style:y(`transform: rotate(90deg) translateX(-${e.vScroll}px);`)},null,4),v("div",{title:"\u5207\u6362\u53C2\u8003\u7EBF",class:"ruler-corner",onClick:t[0]||(t[0]=(...r)=>e.toggleGuides&&e.toggleGuides(...r))},[q(a,null,{default:te(()=>[e.visible?(w(),W(l,{key:0,style:{"z-index":"10"}})):(w(),W(c,{key:1}))]),_:1})])])}var Ne=k(Ve,[["render",qe]]);const Ze=[{direction:"lt",angle:0},{direction:"t",angle:45},{direction:"rt",angle:90},{direction:"r",angle:135},{direction:"rb",angle:180},{direction:"b",angle:225},{direction:"lb",angle:270},{direction:"l",angle:315}],P=[{start:338,end:23,cursor:"nwse-resize"},{start:23,end:68,cursor:"ns-resize"},{start:68,end:113,cursor:"nesw-resize"},{start:113,end:158,cursor:"ew-resize"},{start:158,end:203,cursor:"nwse-resize"},{start:203,end:248,cursor:"ns-resize"},{start:248,end:293,cursor:"nesw-resize"},{start:293,end:338,cursor:"ew-resize"}],je=e=>{const t=(e+360)%360,n={};let i=-1;return Ze.forEach(o=>{const s=(o.angle+t)%360,l=P.length,c=0;for(;c<l;){i=(i+1)%l;const a=P[i];if(s<23||s>=338){n[o.direction]="nwse-resize";break}if(a.start<=s&&s<a.end){n[o.direction]=a.cursor;break}}}),n};function Ue(e){return e*Math.PI/180}function Je(e,t){return{x:e.x+(t.x-e.x)/2,y:e.y+(t.y-e.y)/2}}function D(e,t,n){const i=Ue(n);return{x:(e.x-t.x)*Math.cos(i)-(e.y-t.y)*Math.sin(i)+t.x,y:(e.x-t.x)*Math.sin(i)+(e.y-t.y)*Math.cos(i)+t.y}}function Ke(e,t,n,i,o,s){const l=Je(n,i),c=D(i,l,-t.deg),a=D(n,l,-t.deg);e[0]==="l"?(s.x=Math.round(a.x/o),s.w=Math.round((c.x-a.x)/o)):e[0]==="r"&&(s.x=Math.round(c.x/o),s.w=Math.round((a.x-c.x)/o)),e[1]==="t"?(s.y=Math.round(a.y/o),s.h=Math.round((c.y-a.y)/o)):e[1]==="b"&&(s.y=Math.round(c.y/o),s.h=Math.round((a.y-c.y)/o))}function Qe(e,t,n,i,o,s,l){const c=D(i,n,-t.deg);if(e==="t"||e==="b"){const a=D({x:n.x,y:c.y},n,t.deg),r=Math.sqrt((a.x-o.x)**2+(a.y-o.y)**2);if(r>0){const h={x:a.x-(a.x-o.x)/2,y:a.y+(o.y-a.y)/2};l.h=Math.round(r/s),l.x=Math.round(h.x/s-t.w/2),l.y=Math.round((h.y-r/2)/s)}}if(e==="l"||e==="r"){const a=D({x:c.x,y:n.y},n,t.deg),r=Math.sqrt((a.x-o.x)**2+(a.y-o.y)**2);if(r>0){const h={x:a.x-(a.x-o.x)/2,y:a.y+(o.y-a.y)/2};l.w=Math.round(r/s),l.x=Math.round((h.x-r/2)/s),l.y=Math.round(h.y/s-t.h/2)}}}function Pe(e,t,n,i,o,s){e==="t"?(s.h=Math.round(t.h+(n.y-i.y)/o),s.y=Math.round(t.y+(i.y-n.y)/o)):e==="rt"?(s.h=Math.round(t.h+(n.y-i.y)/o),s.w=Math.round(t.w+(i.x-n.x)/o),s.y=Math.round(t.y+(i.y-n.y)/o)):e==="r"?s.w=Math.round(t.w+(i.x-n.x)/o):e==="rb"?(s.h=Math.round(t.h+(i.y-n.y)/o),s.w=Math.round(t.w+(i.x-n.x)/o)):e==="b"?s.h=Math.round(t.h+(i.y-n.y)/o):e==="lb"?(s.h=Math.round(t.h+(i.y-n.y)/o),s.w=Math.round(t.w+(n.x-i.x)/o),s.x=Math.round(t.x+(i.x-n.x)/o)):e==="l"?(s.w=Math.round(t.w+(n.x-i.x)/o),s.x=Math.round(t.x+(i.x-n.x)/o)):e==="lt"&&(s.h=Math.round(t.h+(n.y-i.y)/o),s.w=Math.round(t.w+(n.x-i.x)/o),s.x=Math.round(t.x+(i.x-n.x)/o),s.y=Math.round(t.y+(i.y-n.y)/o))}const le=(e,t,n,i,o,s,l,c)=>{const a=T({},n.attr),r=Object.create(null);let h,d,u;if(s==="stretch"){const f={x:(a.x+a.w/2)*i,y:(a.y+a.h/2)*i};h=document.getElementById("canvas-coms").getBoundingClientRect(),d={x:e.clientX-h.left,y:e.clientY-h.top},u={x:f.x-(d.x-f.x),y:f.y-(d.y-f.y)}}const g=f=>{if(t)if(s==="normal")Pe(t,a,{x:e.clientX,y:e.clientY},{x:f.clientX,y:f.clientY},i,r);else{const $={x:f.clientX-h.left,y:f.clientY-h.top};t.length===1?Qe(t,a,d,$,u,i,r):Ke(t,a,$,u,i,r)}else r.x=a.x+Math.round((f.clientX-e.clientX)/i/o)*o,r.y=a.y+Math.round((f.clientY-e.clientY)/i/o)*o;n.attr=T(T({},n.attr),r),l()},m=()=>{C(document,"mousemove",g),C(document,"mouseup",m),c()};b(document,"mousemove",g),b(document,"mouseup",m)},et=(e,t,n,i,o,s,l)=>{le(e,t,n,i,0,o?"normal":"stretch",s,l)},tt=(e,t,n,i,o,s)=>{le(e,null,t,n,i,null,o,s)},nt=(e,t,n,i,o)=>{const s=t.getBoundingClientRect(),l=s.left+s.width/2,c=s.top+s.height/2,a=Math.atan2(c-e.clientY,l-e.clientX)*180/Math.PI-n.attr.deg,r=d=>{const u=Math.atan2(c-d.clientY,l-d.clientX)*180/Math.PI-a,g=Math.round(u%360);n.attr.deg=g<0?g+360:g,i()},h=()=>{C(document,"mousemove",r),C(document,"mouseup",h),o()};b(document,"mousemove",r),b(document,"mouseup",h)};const ot=G({name:"ReferLine",props:{attr:{type:Object,required:!0},scale:{type:Number,required:!0}},setup(e){const t=p(()=>({height:`${e.attr.y+60/e.scale}px`,borderLeftWidth:`${.9/e.scale}px`})),n=p(()=>({width:`${e.attr.x+60/e.scale}px`,borderTopWidth:`${.9/e.scale}px`})),i=p(()=>({fontSize:`${12/e.scale}px`,top:`-${6/e.scale}px`,left:`-${6/e.scale}px`}));return{topLineStyle:t,leftLineStyle:n,accountStyle:i}}}),st={class:"nav-line"};function it(e,t,n,i,o,s){return w(),L("div",st,[v("div",{class:"nav-line-top",style:y(e.topLineStyle)},null,4),v("div",{class:"nav-line-left",style:y(e.leftLineStyle)},null,4),v("div",{class:"nav-line-account",style:y(e.accountStyle)},U(e.attr.x)+", "+U(e.attr.y),5)])}var at=k(ot,[["render",it],["__scopeId","data-v-31d69b24"]]);const lt=G({name:"DatavTransform",components:{ReferLine:at},props:{com:{type:Object,required:!0}},setup(e){const t=pe(),n=V(),i=ie(),o=p(()=>n.referLine),s=p(()=>n.canvas.scale),l=p(()=>({selected:e.com.selected,hided:e.com.hided,locked:e.com.locked})),c=p(()=>({top:0,left:0,width:`${e.com.attr.w}px`,height:`${e.com.attr.h}px`,transform:`translate(${e.com.attr.x}px, ${e.com.attr.y}px)`})),a=p(()=>({display:e.com.hided?"none":"block"})),r=p(()=>({hided:!e.com.selected||e.com.locked})),h=p(()=>({cursor:"move",transform:`rotate(${e.com.attr.deg}deg)`})),d=p(()=>{const{hided:x,attr:Y}=e.com,z=n.pageConfig.styleFilterParams;let Z="";return z.enable&&(Z=`hue-rotate(${z.hue}deg) contrast(${z.contrast}%) opacity(${z.opacity}%) saturate(${z.saturate}%) brightness(${z.brightness}%)`),{display:x?"none":"block",transform:`scaleX(${Y.filpH?-1:1}) scaleY(${Y.filpV?-1:1}) rotateZ(360deg)`,filter:Z}}),u=p(()=>({width:`${e.com.attr.w}px`,height:`${e.com.attr.h}px`})),g=p(()=>je(e.com.attr.deg)),m=p(()=>{const x=`scale(${1/s.value}, ${1/s.value})`;return{t:{name:"top",style:{cursor:g.value.t,transform:x}},rt:{name:"top-right",style:{cursor:g.value.rt},rotateStyle:{"transform-origin":"25% 75%",transform:x}},r:{name:"right",style:{cursor:g.value.r,transform:x}},rb:{name:"bottom-right",style:{cursor:g.value.rb},rotateStyle:{"transform-origin":"25% 25%",transform:x}},b:{name:"bottom",style:{cursor:g.value.b,transform:x}},lb:{name:"bottom-left",style:{cursor:g.value.lb},rotateStyle:{"transform-origin":"75% 25%",transform:x}},l:{name:"left",style:{cursor:g.value.l,transform:x}},lt:{name:"top-left",style:{cursor:g.value.lt},rotateStyle:{"transform-origin":"75% 75%",transform:x}}}}),f=()=>{e.com.selected||i.selectCom(e.com.id)},$=()=>{e.com.hovered=!0},_=()=>{e.com.hovered=!1},F=x=>{f(),tt(x,e.com,s.value,n.pageConfig.grid,()=>{n.calcAlignLine(e.com)},()=>{n.hideAlignLine(e.com.id)})},re=(x,Y)=>{f(),et(x,Y,e.com,s.value,n.isNormalResizeMode,()=>{n.calcAlignLine(e.com)},()=>{n.hideAlignLine(e.com.id)})},ce=x=>{nt(x,t.vnode.el,e.com,()=>{},()=>{n.hideAlignLine(e.com.id)})},{showMenu:de}=be();return{referLine:o,scale:s,transformClass:l,transformStyle:c,hideStyle:a,handlerClass:r,handlerStyle:h,comStyle:d,wrapperStyle:u,points:m,onEnter:$,onLeave:_,onMove:F,onZoom:re,onRotate:ce,showMenu:de}}}),rt=e=>(oe("data-v-74401d99"),e=e(),se(),e),ct=["onMousedown"],dt=["onMousedown"],ut=rt(()=>v("div",{class:"transform-bg"},null,-1));function ht(e,t,n,i,o,s){const l=R("refer-line");return w(),L("div",{class:E(["datav-transform",e.transformClass]),style:y(e.transformStyle)},[e.referLine.enable&&e.com.selected?(w(),W(l,{key:0,attr:e.com.attr,scale:e.scale},null,8,["attr","scale"])):ee("",!0),v("div",{class:E(["datav-scale",{hovered:e.com.hovered}]),style:y(e.hideStyle),onMouseenter:t[2]||(t[2]=(...c)=>e.onEnter&&e.onEnter(...c)),onMouseleave:t[3]||(t[3]=(...c)=>e.onLeave&&e.onLeave(...c)),onMousedown:t[4]||(t[4]=I((...c)=>e.onMove&&e.onMove(...c),["prevent","stop"]))},[v("div",{class:E(["transform-handler",e.handlerClass]),style:y(e.handlerStyle)},[v("div",{class:"datav-com",style:y(e.comStyle)},[ye(e.$slots,"default",{},void 0,!0),v("div",{class:"datav-wrapper-event-disable",style:y(e.wrapperStyle),onContextmenu:t[0]||(t[0]=(...c)=>e.showMenu&&e.showMenu(...c))},null,36)],4),(w(!0),L(N,null,ne(e.points,(c,a)=>(w(),L(N,{key:a},[c.rotateStyle?(w(),L("i",{key:0,class:E(`${c.name}-handler`),"data-html2canvas-ignore":""},[v("span",{class:"rotate-handler",style:y(c.rotateStyle),onMousedown:t[1]||(t[1]=I((...r)=>e.onRotate&&e.onRotate(...r),["prevent","stop"]))},[v("span",{class:"control-point",style:y(c.style),onMousedown:I(r=>e.onZoom(r,a),["prevent","stop"])},null,44,ct)],36)],2)):(w(),L("i",{key:1,class:E(`${c.name}-handler`),"data-html2canvas-ignore":""},[v("span",{class:"control-point",style:y(c.style),onMousedown:I(r=>e.onZoom(r,a),["prevent","stop"])},null,44,dt)],2))],64))),128)),ut],6)],38)],6)}var mt=k(lt,[["render",ht],["__scopeId","data-v-74401d99"]]);const ft=G({name:"CanvasMain",components:{AlignLine:Ye,Ruler:Ne,DatavTransform:mt},setup(){const e=$e(),t=ie(),n=V(),i=Me(),{pageConfig:o,canvas:s}=J(n),{coms:l}=J(t),c=p(()=>({width:`${s.value.width}px`,height:`${s.value.height}px`})),a=p(()=>({position:"absolute",width:`${o.value.width}px`,height:`${o.value.height}px`,transform:`scale(${s.value.scale}) translate(0px, 0px)`,backgroundImage:`url(${o.value.bgimage})`,backgroundColor:o.value.bgcolor}));return{coms:l,screenShotStyle:c,canvasPanelStyle:a,dropToAddCom:async u=>{u.preventDefault();try{const g=u.dataTransfer.getData("text");if(g){e.addLoading();let m=await Le(g);const{scale:f}=s.value,$=(u.clientX-e.getPanelOffsetLeft)/f,_=(u.clientY-e.getPanelOffsetTop)/f;m.attr.x=Math.round($-m.attr.w/2),m.attr.y=Math.round(_-m.attr.h/2),await t.addCom(m),t.selectCom(m.id),e.removeLoading(),m.apis.source&&(await m.loadData(),we(()=>{var F;(F=i.events[m.id])==null||F.requestData()}))}}catch{}},cancelSelectCom:()=>{t.selectCom("")},dragOver:u=>{u.preventDefault(),u.stopPropagation(),u.dataTransfer.dropEffect="copy"}}}}),vt=e=>(oe("data-v-61a402fb"),e=e(),se(),e),gt={class:"canvas-main"},yt=vt(()=>v("div",{class:"thumbnail"},null,-1));function pt(e,t,n,i,o,s){const l=R("align-line"),c=R("ruler"),a=R("datav-transform");return w(),L("div",gt,[v("div",{id:"canvas-wp",class:"canvas-panel-wrap",onMousedown:t[2]||(t[2]=I((...r)=>e.cancelSelectCom&&e.cancelSelectCom(...r),["stop"]))},[v("div",{class:"screen-shot",style:y(e.screenShotStyle)},[q(l),q(c),v("div",{id:"canvas-coms",class:"canvas-panel",style:y(e.canvasPanelStyle),onDragover:t[0]||(t[0]=(...r)=>e.dragOver&&e.dragOver(...r)),onDrop:t[1]||(t[1]=(...r)=>e.dropToAddCom&&e.dropToAddCom(...r))},[(w(!0),L(N,null,ne(e.coms,r=>(w(),W(a,{key:r.id,com:r},{default:te(()=>[(w(),W(xe(r.name),{com:r,style:y({transform:"translateZ(0px)",opacity:r.attr.opacity})},null,8,["com","style"]))]),_:2},1032,["com"]))),128))],36)],4)],32),yt])}var _t=k(ft,[["render",pt],["__scopeId","data-v-61a402fb"]]);export{_t as default};
