var e=Object.defineProperty,t=Object.defineProperties,o=Object.getOwnPropertyDescriptors,a=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable,s=(t,o,a)=>o in t?e(t,o,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[o]=a,i=(e,t)=>{for(var o in t||(t={}))n.call(t,o)&&s(e,o,t[o]);if(a)for(var o of a(t))l.call(t,o)&&s(e,o,t[o]);return e};import{av as c,aw as r,ax as d,ay as u,az as m,aA as v,d as p,aB as f,l as h,m as b,A as g,aC as y,aD as C,y as x,z as w,k as _,p as k,v as S,F as P,r as L,w as D,o as M,h as T,aE as E,ag as j,ah as I,ap as O,ar as F,s as V,aF as A,e as H,aG as z,aH as R,af as Y,aq as N,t as W,aI as $,aJ as U}from"./index.53b5ff23.js";import{o as B,b as X}from"./dom.02060888.js";class K extends c{constructor(){super("MainTitle",{w:300,h:56}),this.config={title:"我是标题数据",textStyle:{fontFamily:"Microsoft Yahei",fontSize:24,color:"#fff",fontWeight:"normal"},textAlign:"center",writingMode:"horizontal-tb",letterSpacing:0,backgroundStyle:{show:!1,bgColor:"#008bff",borderRadius:15,borderColor:"#fff",borderStyle:"solid",borderWidth:1},ellipsis:!1,urlConfig:{url:"",isBlank:!1}},this.events={},this.initData()}initData(){const e=[r("title",{description:"标题值",optional:!0}),r("url",{description:"超链接",optional:!0})];return this.apis=d({},"source",{fields:Object.assign({},...e)}),this.apiData=u(this.id,{},"source",{title:"我是标题数据",url:""}),this}}class q extends c{constructor(){super("NumberTitleFlop",{w:350,h:100}),this.config={arrangement:"top",distance:0,title:{content:"我是标题",textStyle:{fontFamily:"Microsoft Yahei",fontSize:15,color:"#fff",fontWeight:"lighter"},textAlign:"center"},counter:{fontFamily:"Microsoft Yahei",justifyContent:"flex-start",margin:{preNum:0,numSuff:0},prefix:{content:"￥",textStyle:{fontSize:50,color:"#fff",fontWeight:"normal"}},suffix:{content:"元",textStyle:{fontSize:30,color:"#fff",fontWeight:"normal"}}},numbers:{textStyle:{fontSize:50,color:"#fff600",fontWeight:"normal"},marginRight:0,bgColor:"rgba(51,51,51,0)",bgRadius:6,bgSeparating:!1,digit:0,decimal:0,divisor:0,separatingChart:!0,separatingSymbol:",",decimalSymbol:".",fixedWidth:0,increment:!0,animation:!0,sameDataFlip:!1,duration:1e3}},this.events={},this.initData()}initData(){const e=[r("title",{description:"标题",optional:!0}),r("value",{description:"翻牌器数值"}),r("prefix",{description:"翻牌器前缀",optional:!0}),r("suffix",{description:"翻牌器后缀",optional:!0})];return this.apis=d({},"source",{fields:Object.assign({},...e)}),this.apiData=u(this.id,{},"source",{title:"",value:"12345.67"}),this}}function J(e){switch(e.substr(1)){case"MainTitle":return new K;case"NumberTitleFlop":return new q;default:throw Error(`Unknown component type: ${e}.`)}}var G=p({name:"HeadLoading",computed:{loadingClass:()=>({"loading-indicator":!0,loading:f.loading>0})}});const Q=g()(((e,t,o,a,n,l)=>(h(),b("div",{class:e.loadingClass},null,2))));G.render=Q,G.__scopeId="data-v-8fb5bcb8";var Z=p({name:"HeaderToolber",components:{HeadLoading:G},computed:{screen:()=>v.screen,layer:()=>f.layer.show,components:()=>f.components.show,config:()=>f.config.show,toolbox:()=>f.toolbox.show,filter:()=>f.filter.show},methods:{changeLayerPanel(){f.setPanelState({type:y.layer,value:!this.layer})},changeComponentsPanel(){f.setPanelState({type:y.components,value:!this.components})},changeConfigPanel(){f.setPanelState({type:y.config,value:!this.config})},changeToolboxPanel(){f.setPanelState({type:y.toolbox,value:!this.toolbox})},changeFilterPanel(){f.filter.show=!this.filter},saveScreen(){const e="DataV-Preview";localStorage.removeItem(e);const a={project:(n=i({},v.screen),l={config:i({},v.pageConfig)},t(n,o(l))),dataFilters:[...C.dataFilters],coms:[...v.coms,...v.subComs]};var n,l;localStorage.setItem(e,JSON.stringify(a))}}});const ee=g();x("data-v-11118f74");const te=k("i",{class:"v-icon-back"},null,-1),oe={class:"editor-header-wp"},ae={class:"editor-config"},ne=k("i",{class:"v-icon-layer head-btn-icon"},null,-1),le=k("i",{class:"v-icon-rpanel head-btn-icon"},null,-1),se=k("i",{class:"v-icon-toolbox head-btn-icon"},null,-1),ie={class:"drawer-actions"},ce=k("i",{class:"v-icon-filter head-btn-icon"},null,-1),re=k("div",{class:["head-btn mr4"]},[k("i",{class:"v-icon-magic head-btn-icon"})],-1),de=k("div",{class:["head-btn mr4"]},[k("i",{class:"v-icon-mobile head-btn-icon"})],-1),ue={class:"screen-info"},me={class:"global-actions"},ve=k("i",{class:"v-icon-save head-btn-icon"},null,-1),pe={class:"head-btn ml4"},fe=k("i",{class:"v-icon-help head-btn-icon"},null,-1),he=k("div",{class:"head-btn ml4"},[k("i",{class:"v-icon-release head-btn-icon"})],-1),be=k("i",{class:"v-icon-preview head-btn-icon"},null,-1);w();const ge=ee(((e,t,o,a,n,l)=>{const s=_("el-tooltip"),i=_("router-link"),c=_("el-col"),r=_("el-row"),d=_("head-loading");return h(),b(P,null,[k(r,{class:"edit-header-wrap"},{default:ee((()=>[k(c,{class:"edit-header"},{default:ee((()=>[k(s,{content:"返回",effect:"blue",enterable:!1},{default:ee((()=>[k("div",{class:"back-btn",onClick:t[1]||(t[1]=t=>e.$router.push("/"))},[te])])),_:1}),k("div",oe,[k("div",ae,[k(s,{content:"图层",effect:"blue","open-delay":500,enterable:!1},{default:ee((()=>[k("div",{class:["head-btn mr4",{"--selected":e.layer}],onClick:t[2]||(t[2]=(...t)=>e.changeLayerPanel&&e.changeLayerPanel(...t))},[ne],2)])),_:1}),k(s,{content:"组件列表",effect:"blue","open-delay":500,enterable:!1},{default:ee((()=>[k("div",{class:["head-btn mr4",{"--selected":e.components}],onClick:t[3]||(t[3]=(...t)=>e.changeComponentsPanel&&e.changeComponentsPanel(...t))},[k("i",{class:["v-icon-box com-list-icon",{"--rotate":!e.components}]},null,2)],2)])),_:1}),k(s,{content:"右侧面板",effect:"blue","open-delay":500,enterable:!1},{default:ee((()=>[k("div",{class:["head-btn mr4",{"--selected":e.config}],onClick:t[4]||(t[4]=(...t)=>e.changeConfigPanel&&e.changeConfigPanel(...t))},[le],2)])),_:1}),k(s,{content:"工具箱",effect:"blue","open-delay":500,enterable:!1},{default:ee((()=>[k("div",{class:["head-btn mr4",{"--selected":e.toolbox}],onClick:t[5]||(t[5]=(...t)=>e.changeToolboxPanel&&e.changeToolboxPanel(...t))},[se],2)])),_:1})]),k("div",ie,[k(s,{content:"数据过滤器",effect:"blue","open-delay":500,enterable:!1},{default:ee((()=>[k("div",{class:["head-btn mr4",{"--selected":e.filter}],onClick:t[6]||(t[6]=(...t)=>e.changeFilterPanel&&e.changeFilterPanel(...t))},[ce],2)])),_:1}),k(s,{content:"美化工具箱",effect:"blue","open-delay":500,enterable:!1},{default:ee((()=>[re])),_:1}),k(s,{content:"迁移至移动端",effect:"blue","open-delay":500,enterable:!1},{default:ee((()=>[de])),_:1})])]),k("div",ue,[k("i",{class:"v-icon-workspace workspace-icon",onClick:t[7]||(t[7]=t=>e.$router.push("/"))}),k("span",null,S("工作空间 - "+e.screen.name),1)]),k("div",me,[k(s,{content:"保存",effect:"blue","open-delay":500,enterable:!1},{default:ee((()=>[k("div",{class:"head-btn ml4",onClick:t[8]||(t[8]=(...t)=>e.saveScreen&&e.saveScreen(...t))},[ve])])),_:1}),k(s,{content:"帮助",effect:"blue","open-delay":500,enterable:!1},{default:ee((()=>[k("div",pe,[k(i,{to:{name:"MyCase"},target:"_blank",class:"full-a"},{default:ee((()=>[fe])),_:1})])])),_:1}),k(s,{content:"发布",effect:"blue","open-delay":500,enterable:!1},{default:ee((()=>[he])),_:1}),k(s,{content:"预览",effect:"blue","open-delay":500,enterable:!1},{default:ee((()=>[k("div",{class:"head-btn ml4",onClick:t[9]||(t[9]=(...t)=>e.saveScreen&&e.saveScreen(...t))},[k(i,{to:{name:"Preview",params:{screenId:e.screen.id}},target:"_blank",class:"full-a"},{default:ee((()=>[be])),_:1},8,["to"])])])),_:1})])])),_:1})])),_:1}),k(d)],64)}));Z.render=ge,Z.__scopeId="data-v-11118f74";var ye=p({name:"FooterToolbar",setup(){const e=L([200,150,100,50]),t=L(20),o=L(20),a=L(!1),n=L(!1),l=()=>{a.value=!1,document.removeEventListener("click",l,!1)},s=()=>({offsetX:f.getPanelOffsetX,offsetY:f.getPanelOffsetY});D((()=>v.canvas.scale),(e=>{const a=parseInt((100*e).toFixed(2));t.value=a,o.value=a}));const c=e=>{const t=e.target;if(!["input","textarea"].includes(t.tagName.toLowerCase())){const t=E();if(!t&&e.ctrlKey||t&&e.metaKey){const t=e.key.toLowerCase(),{setPanelState:o}=f;"arrowleft"===t?o({type:y.layer,value:!f.layer.show}):"arrowup"===t?o({type:y.components,value:!f.components.show}):"arrowright"===t?o({type:y.config,value:!f.config.show}):"a"===t&&v.autoCanvasScale(s),e.preventDefault()}}};return M((()=>{document.addEventListener("keydown",c,!1)})),T((()=>{document.removeEventListener("keydown",c,!1)})),{scaleList:e,scale:t,inputScale:o,visibleScaleList:a,showScaleList:()=>{a.value=!0,document.addEventListener("click",l,!1)},useSlider:n,submitScale:async e=>{-1===e?v.autoCanvasScale(s):v.setCanvasScale(i({scale:0===e?o.value:e},s())),l()}}}});const Ce=g();x("data-v-501a70aa");const xe=k("i",{class:"v-icon-keyboard shortcut-btn"},null,-1),we=k("div",{class:"shortcut-wp"},[k("div",{class:"shortcut-item"},[k("div",{class:"shortcut-title"},"开关图层面板"),k("div",{class:"shortcut-value"},"Ctrl/Cmd + ←")]),k("div",{class:"shortcut-item"},[k("div",{class:"shortcut-title"},"切换组件面板"),k("div",{class:"shortcut-value"},"Ctrl/Cmd + ↑")]),k("div",{class:"shortcut-item"},[k("div",{class:"shortcut-title"},"切换右侧面板"),k("div",{class:"shortcut-value"},"Ctrl/Cmd + →")]),k("div",{class:"shortcut-item"},[k("div",{class:"shortcut-title"},"画布缩放到最佳位置"),k("div",{class:"shortcut-value"},"Ctrl/Cmd + a")])],-1),_e={class:"scale-input-wp"},ke=k("span",{class:"percent"},"%",-1),Se={class:"scale-value-list"},Pe={class:"scale-slider-wp"};w();const Le=Ce(((e,t,o,a,n,l)=>{const s=_("el-popover"),i=_("el-slider"),c=_("el-footer");return h(),b(c,{height:"32px",class:"bottom-sider"},{default:Ce((()=>[k(s,{width:"235",placement:"top",trigger:"hover","popper-class":"editor-popover"},{reference:Ce((()=>[xe])),default:Ce((()=>[we])),_:1}),k("div",_e,[j(k("input",{"onUpdate:modelValue":t[1]||(t[1]=t=>e.inputScale=t),type:"number",class:"scale-input",onKeydown:t[2]||(t[2]=O((t=>e.submitScale(0)),["enter"]))},null,544),[[I,e.inputScale]]),ke,k(s,{visible:e.visibleScaleList,width:"56",placement:"top",trigger:"click","popper-class":"editor-popover","show-arrow":!1,offset:5},{reference:Ce((()=>[k("i",{class:"el-icon-arrow-down open-icon",onClick:t[4]||(t[4]=F(((...t)=>e.showScaleList&&e.showScaleList(...t)),["stop"]))})])),default:Ce((()=>[k("div",Se,[(h(!0),b(P,null,V(e.scaleList,(t=>(h(),b("div",{key:t,class:"scale-value-item",onClick:o=>e.submitScale(t)},S(`${t}%`),9,["onClick"])))),128)),k("div",{class:"scale-value-item",onClick:t[3]||(t[3]=t=>e.submitScale(-1))},"自适应")])])),_:1},8,["visible"])]),k("div",Pe,[k(i,{modelValue:e.scale,"onUpdate:modelValue":t[5]||(t[5]=t=>e.scale=t),min:10,max:200,step:5,"show-tooltip":!1,onChange:e.submitScale},null,8,["modelValue","onChange"])])])),_:1})}));ye.render=Le,ye.__scopeId="data-v-501a70aa";const De=A({x:0,y:0}),Me=e=>{const t=H((()=>v.contextMenu)),o=H((()=>v.selectedCom)),a=H((()=>{var e;return null==(e=o.value)?void 0:e.locked})),n=H((()=>{var e;return null==(e=o.value)?void 0:e.hided})),l=H((()=>({display:t.value.show?"block":"none",left:`${De.x+10}px`,top:`${De.y+10}px`,transform:document.documentElement.clientHeight-De.y<250?"translate(0px, -100%)":""}))),s=()=>{X(document,"click",s),e&&e.beforeClose&&e.beforeClose(),t.value.show=!1};return{contextMenu:t,selectedCom:o,isLocked:a,isHided:n,contextMenuStyle:l,showMenu:e=>{e.preventDefault(),o.value&&(De.x=e.clientX,De.y=e.clientY,t.value.show=!0,B(document,"click",s))},hideMenu:s}};var Te=p({name:"EditorContextMenu",setup(){const{contextMenu:e,selectedCom:t,isLocked:o,isHided:a,contextMenuStyle:n}=Me(),l=e=>{t.value&&v.moveCom({id:t.value.id,moveType:e})},s=e=>e.preventDefault();return z((()=>{B(document,"contextmenu",s)})),T((()=>{X(document,"contextmenu",s)})),{contextMenu:e,isLocked:o,isHided:a,contextMenuStyle:n,moveUp:()=>l(R.up),moveDown:()=>l(R.down),moveTop:()=>l(R.top),moveBottom:()=>l(R.bottom),lockCom:()=>{t.value&&(t.value.locked=!t.value.locked)},hideCom:()=>{t.value&&(t.value.hided=!t.value.hided)},toDeleteCom:()=>{const e=t.value;e&&Y.confirmAsync("是否删除选中的1个组件",(()=>v.deleteCom(e)))},renameCom:()=>{t.value&&(t.value.renameing=!0)},toCopyCom:()=>{t.value&&v.copyCom(t.value.id)}}}});const Ee=g();x("data-v-e35305b2");const je=k("i",{class:"menu-icon v-icon-move-top"},null,-1),Ie=W("置顶 "),Oe=k("i",{class:"menu-icon v-icon-move-bottom"},null,-1),Fe=W("置底 "),Ve=k("i",{class:"menu-icon v-icon-move-up"},null,-1),Ae=W("上移一层 "),He=k("i",{class:"menu-icon v-icon-move-down"},null,-1),ze=W("下移一层 "),Re=k("div",{class:"context-menu-divider"},null,-1),Ye=k("i",{class:"menu-icon v-icon-unlock"},null,-1),Ne=W("解锁 "),We=k("i",{class:"menu-icon v-icon-lock"},null,-1),$e=W("锁定 "),Ue=k("i",{class:"menu-icon v-icon-show"},null,-1),Be=W("显示 "),Xe=k("i",{class:"menu-icon v-icon-hide"},null,-1),Ke=W("隐藏 "),qe=k("div",{class:"context-menu-divider"},null,-1),Je=k("i",{class:"menu-icon v-icon-edit"},null,-1),Ge=W("重命名 "),Qe=k("i",{class:"menu-icon v-icon-copy"},null,-1),Ze=W("复制 "),et=k("i",{class:"menu-icon v-icon-delete"},null,-1),tt=W("删除 "),ot=k("div",{class:"context-menu-divider"},null,-1);w();const at=Ee(((e,t,o,a,n,l)=>e.contextMenu.show?(h(),b("div",{key:0,class:"context-menu-wrap",style:e.contextMenuStyle},[k("div",{class:"context-menu-item",onClick:t[1]||(t[1]=(...t)=>e.moveTop&&e.moveTop(...t))},[je,Ie]),k("div",{class:"context-menu-item",onClick:t[2]||(t[2]=(...t)=>e.moveBottom&&e.moveBottom(...t))},[Oe,Fe]),k("div",{class:"context-menu-item",onClick:t[3]||(t[3]=(...t)=>e.moveUp&&e.moveUp(...t))},[Ve,Ae]),k("div",{class:"context-menu-item",onClick:t[4]||(t[4]=(...t)=>e.moveDown&&e.moveDown(...t))},[He,ze]),Re,k("div",{class:"context-menu-item",onClick:t[5]||(t[5]=(...t)=>e.lockCom&&e.lockCom(...t))},[e.isLocked?(h(),b(P,{key:0},[Ye,Ne],64)):(h(),b(P,{key:1},[We,$e],64))]),k("div",{class:"context-menu-item",onClick:t[6]||(t[6]=(...t)=>e.hideCom&&e.hideCom(...t))},[e.isHided?(h(),b(P,{key:0},[Ue,Be],64)):(h(),b(P,{key:1},[Xe,Ke],64))]),qe,k("div",{class:"context-menu-item",onClick:t[7]||(t[7]=(...t)=>e.renameCom&&e.renameCom(...t))},[Je,Ge]),k("div",{class:"context-menu-item",onClick:t[8]||(t[8]=(...t)=>e.toCopyCom&&e.toCopyCom(...t))},[Qe,Ze]),k("div",{class:"context-menu-item",onClick:t[9]||(t[9]=(...t)=>e.toDeleteCom&&e.toDeleteCom(...t))},[et,tt]),ot],4)):N("",!0)));Te.render=at,Te.__scopeId="data-v-e35305b2";var nt=p({name:"Screen",components:{HeaderToolbar:Z,FooterToolbar:ye,EditorContextMenu:Te,CanvasMain:$((()=>U((()=>import("./index.ba7e4d69.js")),["/assets/index.ba7e4d69.js","/assets/index.c91c2298.css","/assets/index.53b5ff23.js","/assets/index.1114ac54.css","/assets/dom.02060888.js"]))),LayerPanel:$((()=>U((()=>import("./index.923588a5.js")),["/assets/index.923588a5.js","/assets/index.8e86452d.css","/assets/index.53b5ff23.js","/assets/index.1114ac54.css","/assets/dom.02060888.js"]))),ComponentsPanel:$((()=>U((()=>import("./index.98be71ed.js")),["/assets/index.98be71ed.js","/assets/index.0bfb3eb0.css","/assets/index.53b5ff23.js","/assets/index.1114ac54.css","/assets/dom.02060888.js"]))),ConfigPanel:$((()=>U((()=>import("./index.83c5bcdd.js")),["/assets/index.83c5bcdd.js","/assets/index.b7bacfd0.css","/assets/index.53b5ff23.js","/assets/index.1114ac54.css","/assets/images.a8ceee1d.js"]))),ToolboxPanel:$((()=>U((()=>import("./index.0fc8df91.js")),["/assets/index.0fc8df91.js","/assets/index.e45cf4bd.css","/assets/index.53b5ff23.js","/assets/index.1114ac54.css"]))),FilterManagerDrawer:$((()=>U((()=>import("./filter-manager-drawer.3ce67913.js")),["/assets/filter-manager-drawer.3ce67913.js","/assets/filter-manager-drawer.42e8fd86.css","/assets/index.53b5ff23.js","/assets/index.1114ac54.css","/assets/filter-collapse-panel.05359e0d.js"])))},props:{projectId:{type:[String,Number],required:!0}},setup(e){const t=L(!0);v.setEditMode();const o=H((()=>"string"==typeof e.projectId?parseInt(e.projectId):e.projectId));return M((()=>{v.loadScreen(o.value).finally((()=>{document.title=`${v.screen.name} | 编辑器`})),v.loadComs(o.value).finally((()=>{t.value=!1,v.autoCanvasScale((()=>({offsetX:f.getPanelOffsetX,offsetY:f.getPanelOffsetY})))})),C.loadFilters(o.value),(()=>{const{pageConfig:e}=v;["VMainTitle","VNumberTitleFlop"].forEach((t=>{const o=J(t);o.attr.x=m(e.width-o.attr.w),o.attr.y=m(e.height-o.attr.h),v.addCom(o)}))})()})),{loading:t,screenId:o}}});const lt=g(),st=lt(((e,t,o,a,n,l)=>{const s=_("header-toolbar"),i=_("el-header"),c=_("layer-panel"),r=_("components-panel"),d=_("filter-manager-drawer"),u=_("toolbox-panel"),m=_("canvas-main"),v=_("g-loading"),p=_("footer-toolbar"),f=_("el-container"),g=_("config-panel"),y=_("editor-context-menu");return h(),b(P,null,[k(f,{class:"edit-container"},{default:lt((()=>[k(i,{style:{height:"auto",padding:"0"}},{default:lt((()=>[k(s)])),_:1}),k(f,{class:"edit-main-wp"},{default:lt((()=>[k(c),k(r),k(d),k(f,{class:"edit-main"},{default:lt((()=>[k(u),k(v,{spinning:e.loading},{default:lt((()=>[k(m)])),_:1},8,["spinning"]),k(p)])),_:1}),k(g)])),_:1})])),_:1}),k(y)],64)}));nt.render=st,nt.__scopeId="data-v-fe242488";var it=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:nt});export{J as c,it as i,Me as u};
