var e=Object.defineProperty,t=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable,a=(t,o,n)=>o in t?e(t,o,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[o]=n;import{ap as l,aq as s,ar as i,as as c,at as r,au as d,d as u,r as m,o as p,c as v,av as f,aw as h,l as b,ax as g,p as y,k as C,a as x,t as _,F as w,g as k,ac as S,i as P,j as L,ay as M,a8 as T,a9 as D,ak as j,am as E,b as I,az as O,a4 as F,aA as V,aB as A,a7 as H,al as z,e as R,aC as Y,aD as W}from"./index.22eaa455.js";import{o as $,b as N}from"./dom.1228cadc.js";class U extends l{constructor(){super("MainTitle",{w:300,h:56}),this.config={title:"我是标题数据",textStyle:{fontFamily:"Microsoft Yahei",fontSize:24,color:"#fff",fontWeight:"normal"},textAlign:"center",writingMode:"horizontal-tb",letterSpacing:0,backgroundStyle:{show:!1,bgColor:"#008bff",borderRadius:15,borderColor:"#fff",borderStyle:"solid",borderWidth:1},ellipsis:!1,urlConfig:{url:"",isBlank:!1}},this.events={},this.initData()}initData(){const e=[s("title",{description:"标题值",optional:!0}),s("url",{description:"超链接",optional:!0})];return this.apis=i({},"source",{fields:Object.assign({},...e)}),this.apiData=c(this.id,{},"source",{title:"我是标题数据",url:""}),this}}class B extends l{constructor(){super("NumberTitleFlop",{w:350,h:100}),this.config={arrangement:"top",distance:0,title:{content:"我是标题",textStyle:{fontFamily:"Microsoft Yahei",fontSize:15,color:"#fff",fontWeight:"lighter"},textAlign:"center"},counter:{fontFamily:"Microsoft Yahei",justifyContent:"flex-start",margin:{preNum:0,numSuff:0},prefix:{content:"￥",textStyle:{fontSize:50,color:"#fff",fontWeight:"normal"}},suffix:{content:"元",textStyle:{fontSize:30,color:"#fff",fontWeight:"normal"}}},numbers:{textStyle:{fontSize:50,color:"#fff600",fontWeight:"normal"},marginRight:0,bgColor:"rgba(51,51,51,0)",bgRadius:6,bgSeparating:!1,digit:0,decimal:0,divisor:0,separatingChart:!0,separatingSymbol:",",decimalSymbol:".",fixedWidth:0,increment:!0,animation:!0,sameDataFlip:!1,duration:1e3}},this.events={},this.initData()}initData(){const e=[s("title",{description:"标题",optional:!0}),s("value",{description:"翻牌器数值"}),s("prefix",{description:"翻牌器前缀",optional:!0}),s("suffix",{description:"翻牌器后缀",optional:!0})];return this.apis=i({},"source",{fields:Object.assign({},...e)}),this.apiData=c(this.id,{},"source",{title:"",value:"12345.67"}),this}}function X(e){switch(e.substr(1)){case"MainTitle":return new U;case"NumberTitleFlop":return new B;default:throw Error(`Unknown component type: ${e}.`)}}var q=u({name:"AsyncLoading"});q.render=function(e,t,o,n,a,l){const s=m("g-loading");return p(),v(s,{type:"square",spinning:!0,class:"g-async-loading"})};const K=e=>f({loader:e,loadingComponent:q,delay:20});var G=u({name:"HeadLoading",computed:{loadingClass:()=>({"loading-indicator":!0,loading:h.loading>0})}});const J=b()(((e,t,o,n,a,l)=>(p(),v("div",{class:e.loadingClass},null,2))));G.render=J,G.__scopeId="data-v-8fb5bcb8";var Q=u({name:"HeaderToolber",components:{HeadLoading:G},computed:{screen:()=>d.screen,layer:()=>h.layer.show,components:()=>h.components.show,config:()=>h.config.show,toolbox:()=>h.toolbox.show},methods:{changeLayerPanel(){h.setPanelState({type:g.layer,value:!this.layer})},changeComponentsPanel(){h.setPanelState({type:g.components,value:!this.components})},changeConfigPanel(){h.setPanelState({type:g.config,value:!this.config})},changeToolboxPanel(){h.setPanelState({type:g.toolbox,value:!this.toolbox})}}});const Z=b();y("data-v-7c9353c4");const ee=x("i",{class:"v-icon-back"},null,-1),te={class:"editor-config"},oe=x("i",{class:"v-icon-layer head-btn-icon"},null,-1),ne=x("i",{class:"v-icon-rpanel head-btn-icon"},null,-1),ae=x("i",{class:"v-icon-toolbox head-btn-icon"},null,-1),le={class:"screen-info"},se={class:"global-actions"},ie=x("div",{class:"head-btn ml4"},[x("i",{class:"v-icon-save head-btn-icon"})],-1),ce={class:"head-btn ml4"},re=x("i",{class:"v-icon-help head-btn-icon"},null,-1),de=x("div",{class:"head-btn ml4"},[x("i",{class:"v-icon-release head-btn-icon"})],-1),ue={class:"head-btn ml4"},me=x("i",{class:"v-icon-preview head-btn-icon"},null,-1);C();const pe=Z(((e,t,o,n,a,l)=>{const s=m("el-tooltip"),i=m("router-link"),c=m("el-col"),r=m("el-row"),d=m("head-loading");return p(),v(w,null,[x(r,{class:"edit-header-wrap"},{default:Z((()=>[x(c,{class:"edit-header"},{default:Z((()=>[x(s,{content:"返回",effect:"blue",enterable:!1},{default:Z((()=>[x("div",{class:"back-btn",onClick:t[1]||(t[1]=t=>e.$router.push("/"))},[ee])])),_:1}),x("div",te,[x(s,{content:"图层",effect:"blue","open-delay":500,enterable:!1},{default:Z((()=>[x("div",{class:["head-btn mr4",{"--selected":e.layer}],onClick:t[2]||(t[2]=(...t)=>e.changeLayerPanel&&e.changeLayerPanel(...t))},[oe],2)])),_:1}),x(s,{content:"组件列表",effect:"blue","open-delay":500,enterable:!1},{default:Z((()=>[x("div",{class:["head-btn mr4",{"--selected":e.components}],onClick:t[3]||(t[3]=(...t)=>e.changeComponentsPanel&&e.changeComponentsPanel(...t))},[x("i",{class:["v-icon-box com-list-icon",{"--rotate":!e.components}]},null,2)],2)])),_:1}),x(s,{content:"右侧面板",effect:"blue","open-delay":500,enterable:!1},{default:Z((()=>[x("div",{class:["head-btn mr4",{"--selected":e.config}],onClick:t[4]||(t[4]=(...t)=>e.changeConfigPanel&&e.changeConfigPanel(...t))},[ne],2)])),_:1}),x(s,{content:"工具箱",effect:"blue","open-delay":500,enterable:!1},{default:Z((()=>[x("div",{class:["head-btn mr4",{"--selected":e.toolbox}],onClick:t[5]||(t[5]=(...t)=>e.changeToolboxPanel&&e.changeToolboxPanel(...t))},[ae],2)])),_:1})]),x("div",le,[x("i",{class:"v-icon-workspace workspace-icon",onClick:t[6]||(t[6]=t=>e.$router.push("/"))}),x("span",null,_("工作空间 - "+e.screen.name),1)]),x("div",se,[x(s,{content:"保存",effect:"blue","open-delay":500,enterable:!1},{default:Z((()=>[ie])),_:1}),x(s,{content:"帮助",effect:"blue","open-delay":500,enterable:!1},{default:Z((()=>[x("div",ce,[x(i,{to:{name:"MyCase"},target:"_blank",class:"full-a"},{default:Z((()=>[re])),_:1})])])),_:1}),x(s,{content:"发布",effect:"blue","open-delay":500,enterable:!1},{default:Z((()=>[de])),_:1}),x(s,{content:"预览",effect:"blue","open-delay":500,enterable:!1},{default:Z((()=>[x("div",ue,[x(i,{to:{name:"Screen",params:{projectId:e.screen.id}},target:"_blank",class:"full-a"},{default:Z((()=>[me])),_:1},8,["to"])])])),_:1})])])),_:1})])),_:1}),x(d)],64)}));Q.render=pe,Q.__scopeId="data-v-7c9353c4";var ve=u({name:"FooterToolbar",setup(){const e=k([200,150,100,50]),l=k(20),s=k(20),i=k(!1),c=k(!1),r=()=>{i.value=!1,document.removeEventListener("click",r,!1)},u=()=>({offsetX:h.getPanelOffsetX,offsetY:h.getPanelOffsetY});S((()=>d.canvas.scale),(e=>{const t=parseInt((100*e).toFixed(2));l.value=t,s.value=t}));const m=e=>{const t=e.target;if(!["input","textarea"].includes(t.tagName.toLowerCase())){const t=M();if(!t&&e.ctrlKey||t&&e.metaKey){const t=e.key.toLowerCase(),{setPanelState:o}=h;"arrowleft"===t?o({type:g.layer,value:!h.layer.show}):"arrowup"===t?o({type:g.components,value:!h.components.show}):"arrowright"===t?o({type:g.config,value:!h.config.show}):"a"===t&&d.autoCanvasScale(u),e.preventDefault()}}};return P((()=>{document.addEventListener("keydown",m,!1)})),L((()=>{document.removeEventListener("keydown",m,!1)})),{scaleList:e,scale:l,inputScale:s,visibleScaleList:i,showScaleList:()=>{i.value=!0,document.addEventListener("click",r,!1)},useSlider:c,submitScale:async e=>{-1===e?d.autoCanvasScale(u):d.setCanvasScale(((e,l)=>{for(var s in l||(l={}))o.call(l,s)&&a(e,s,l[s]);if(t)for(var s of t(l))n.call(l,s)&&a(e,s,l[s]);return e})({scale:0===e?s.value:e},u())),r()}}}});const fe=b();y("data-v-72698521");const he=x("i",{class:"v-icon-keyboard shortcut-btn"},null,-1),be=x("div",{class:"shortcut-wp"},[x("div",{class:"shortcut-item"},[x("div",{class:"shortcut-title"},"开关图层面板"),x("div",{class:"shortcut-value"},"Ctrl/Cmd + ←")]),x("div",{class:"shortcut-item"},[x("div",{class:"shortcut-title"},"切换组件面板"),x("div",{class:"shortcut-value"},"Ctrl/Cmd + ↑")]),x("div",{class:"shortcut-item"},[x("div",{class:"shortcut-title"},"切换右侧面板"),x("div",{class:"shortcut-value"},"Ctrl/Cmd + →")]),x("div",{class:"shortcut-item"},[x("div",{class:"shortcut-title"},"画布缩放到最佳位置"),x("div",{class:"shortcut-value"},"Ctrl/Cmd + a")])],-1),ge={class:"scale-input-wp"},ye=x("span",{class:"percent"},"%",-1),Ce={class:"scale-value-list"},xe={class:"scale-slider-wp"};C();const _e=fe(((e,t,o,n,a,l)=>{const s=m("el-popover"),i=m("el-slider"),c=m("el-footer");return p(),v(c,{height:"32px",class:"bottom-sider"},{default:fe((()=>[x(s,{width:"235",placement:"top",trigger:"hover","popper-class":"editor-popover"},{reference:fe((()=>[he])),default:fe((()=>[be])),_:1}),x("div",ge,[T(x("input",{"onUpdate:modelValue":t[1]||(t[1]=t=>e.inputScale=t),type:"number",class:"scale-input",onKeydown:t[2]||(t[2]=j((t=>e.submitScale(0)),["enter"]))},null,544),[[D,e.inputScale]]),ye,x(s,{visible:e.visibleScaleList,width:"56",placement:"top",trigger:"click","popper-class":"editor-popover","show-arrow":!1},{reference:fe((()=>[x("i",{class:"el-icon-arrow-down open-icon",onClick:t[4]||(t[4]=E(((...t)=>e.showScaleList&&e.showScaleList(...t)),["stop"]))})])),default:fe((()=>[x("div",Ce,[(p(!0),v(w,null,I(e.scaleList,(t=>(p(),v("div",{key:t,class:"scale-value-item",onClick:o=>e.submitScale(t)},_(`${t}%`),9,["onClick"])))),128)),x("div",{class:"scale-value-item",onClick:t[3]||(t[3]=t=>e.submitScale(-1))},"自适应")])])),_:1},8,["visible"])]),x("div",xe,[x(i,{modelValue:e.scale,"onUpdate:modelValue":t[5]||(t[5]=t=>e.scale=t),min:20,max:200,step:5,"show-tooltip":!1,onChange:e.submitScale},null,8,["modelValue","onChange"])])])),_:1})}));ve.render=_e,ve.__scopeId="data-v-72698521";const we=O({x:0,y:0}),ke=e=>{const t=F((()=>d.contextMenu)),o=F((()=>d.selectedCom)),n=F((()=>{var e;return null==(e=o.value)?void 0:e.locked})),a=F((()=>{var e;return null==(e=o.value)?void 0:e.hided})),l=F((()=>({display:t.value.show?"block":"none",left:`${we.x+10}px`,top:`${we.y+10}px`,transform:document.documentElement.clientHeight-we.y<250?"translate(0px, -100%)":""}))),s=()=>{N(document,"click",s),e&&e.beforeClose&&e.beforeClose(),t.value.show=!1};return{contextMenu:t,selectedCom:o,isLocked:n,isHided:a,contextMenuStyle:l,showMenu:e=>{e.preventDefault(),o.value&&(we.x=e.clientX,we.y=e.clientY,t.value.show=!0,$(document,"click",s))},hideMenu:s}};var Se=u({name:"EditorContextMenu",setup(){const{contextMenu:e,selectedCom:t,isLocked:o,isHided:n,contextMenuStyle:a}=ke(),l=e=>{t.value&&d.moveCom({id:t.value.id,moveType:e})},s=e=>e.preventDefault();return V((()=>{$(document,"contextmenu",s)})),L((()=>{N(document,"contextmenu",s)})),{contextMenu:e,isLocked:o,isHided:n,contextMenuStyle:a,moveUp:()=>l(A.up),moveDown:()=>l(A.down),moveTop:()=>l(A.top),moveBottom:()=>l(A.bottom),lockCom:()=>{t.value&&(t.value.locked=!t.value.locked)},hideCom:()=>{t.value&&(t.value.hided=!t.value.hided)},toDeleteCom:()=>{const e=t.value;e&&H.confirmAsync("是否删除选中的1个组件",(()=>d.deleteCom(e)))},renameCom:()=>{t.value&&(t.value.renameing=!0)},toCopyCom:()=>{t.value&&d.copyCom(t.value.id)}}}});const Pe=b();y("data-v-e35305b2");const Le=x("i",{class:"menu-icon v-icon-move-top"},null,-1),Me=R("置顶 "),Te=x("i",{class:"menu-icon v-icon-move-bottom"},null,-1),De=R("置底 "),je=x("i",{class:"menu-icon v-icon-move-up"},null,-1),Ee=R("上移一层 "),Ie=x("i",{class:"menu-icon v-icon-move-down"},null,-1),Oe=R("下移一层 "),Fe=x("div",{class:"context-menu-divider"},null,-1),Ve=x("i",{class:"menu-icon v-icon-unlock"},null,-1),Ae=R("解锁 "),He=x("i",{class:"menu-icon v-icon-lock"},null,-1),ze=R("锁定 "),Re=x("i",{class:"menu-icon v-icon-show"},null,-1),Ye=R("显示 "),We=x("i",{class:"menu-icon v-icon-hide"},null,-1),$e=R("隐藏 "),Ne=x("div",{class:"context-menu-divider"},null,-1),Ue=x("i",{class:"menu-icon v-icon-edit"},null,-1),Be=R("重命名 "),Xe=x("i",{class:"menu-icon v-icon-copy"},null,-1),qe=R("复制 "),Ke=x("i",{class:"menu-icon v-icon-delete"},null,-1),Ge=R("删除 "),Je=x("div",{class:"context-menu-divider"},null,-1);C();const Qe=Pe(((e,t,o,n,a,l)=>e.contextMenu.show?(p(),v("div",{key:0,class:"context-menu-wrap",style:e.contextMenuStyle},[x("div",{class:"context-menu-item",onClick:t[1]||(t[1]=(...t)=>e.moveTop&&e.moveTop(...t))},[Le,Me]),x("div",{class:"context-menu-item",onClick:t[2]||(t[2]=(...t)=>e.moveBottom&&e.moveBottom(...t))},[Te,De]),x("div",{class:"context-menu-item",onClick:t[3]||(t[3]=(...t)=>e.moveUp&&e.moveUp(...t))},[je,Ee]),x("div",{class:"context-menu-item",onClick:t[4]||(t[4]=(...t)=>e.moveDown&&e.moveDown(...t))},[Ie,Oe]),Fe,x("div",{class:"context-menu-item",onClick:t[5]||(t[5]=(...t)=>e.lockCom&&e.lockCom(...t))},[e.isLocked?(p(),v(w,{key:0},[Ve,Ae],64)):(p(),v(w,{key:1},[He,ze],64))]),x("div",{class:"context-menu-item",onClick:t[6]||(t[6]=(...t)=>e.hideCom&&e.hideCom(...t))},[e.isHided?(p(),v(w,{key:0},[Re,Ye],64)):(p(),v(w,{key:1},[We,$e],64))]),Ne,x("div",{class:"context-menu-item",onClick:t[7]||(t[7]=(...t)=>e.renameCom&&e.renameCom(...t))},[Ue,Be]),x("div",{class:"context-menu-item",onClick:t[8]||(t[8]=(...t)=>e.toCopyCom&&e.toCopyCom(...t))},[Xe,qe]),x("div",{class:"context-menu-item",onClick:t[9]||(t[9]=(...t)=>e.toDeleteCom&&e.toDeleteCom(...t))},[Ke,Ge]),Je],4)):z("",!0)));Se.render=Qe,Se.__scopeId="data-v-e35305b2";var Ze=u({name:"Screen",components:{HeaderToolbar:Q,FooterToolbar:ve,EditorContextMenu:Se,CanvasMain:K((()=>W((()=>import("./index.98472219.js")),["/assets/index.98472219.js","/assets/index.8d8d2f2a.css","/assets/index.22eaa455.js","/assets/index.079790e4.css","/assets/editor.worker.3eb73e22.js","/assets/dom.1228cadc.js"]))),LayerPanel:K((()=>W((()=>import("./index.e0e3bade.js")),["/assets/index.e0e3bade.js","/assets/index.a07efb54.css","/assets/index.22eaa455.js","/assets/index.079790e4.css","/assets/editor.worker.3eb73e22.js","/assets/dom.1228cadc.js"]))),ComponentsPanel:K((()=>W((()=>import("./index.0802ac63.js")),["/assets/index.0802ac63.js","/assets/index.76c375ad.css","/assets/index.22eaa455.js","/assets/index.079790e4.css","/assets/editor.worker.3eb73e22.js","/assets/dom.1228cadc.js"]))),ConfigPanel:K((()=>W((()=>import("./index.7fb63c79.js")),["/assets/index.7fb63c79.js","/assets/index.968192d8.css","/assets/index.22eaa455.js","/assets/index.079790e4.css","/assets/editor.worker.3eb73e22.js","/assets/images.a8ceee1d.js","/assets/dom.1228cadc.js"]))),ToolboxPanel:K((()=>W((()=>import("./index.e3acf70e.js")),["/assets/index.e3acf70e.js","/assets/index.e45cf4bd.css","/assets/index.22eaa455.js","/assets/index.079790e4.css","/assets/editor.worker.3eb73e22.js"])))},props:{projectId:{type:[String,Number],required:!0}},setup(e){const t=k(!0);d.setEditMode();const o=F((()=>"string"==typeof e.projectId?parseInt(e.projectId):e.projectId));return P((()=>{d.loadScreen(o.value).finally((()=>{document.title=`${d.screen.name} | 编辑器`})),d.loadComs(o.value).finally((()=>{t.value=!1,d.autoCanvasScale((()=>({offsetX:h.getPanelOffsetX,offsetY:h.getPanelOffsetY})))})),Y.loadFilters(o.value),(()=>{const{pageConfig:e}=d;["VMainTitle","VNumberTitleFlop"].forEach((t=>{const o=X(t);o.attr.x=r(e.width-o.attr.w),o.attr.y=r(e.height-o.attr.h),d.addCom(o)}))})()})),{loading:t,screenId:o}}});const et=b(),tt=et(((e,t,o,n,a,l)=>{const s=m("header-toolbar"),i=m("el-header"),c=m("layer-panel"),r=m("components-panel"),d=m("toolbox-panel"),u=m("canvas-main"),f=m("g-loading"),h=m("footer-toolbar"),b=m("el-container"),g=m("config-panel"),y=m("editor-context-menu");return p(),v(w,null,[x(b,{class:"edit-container"},{default:et((()=>[x(i,{style:{height:"auto",padding:"0"}},{default:et((()=>[x(s)])),_:1}),x(b,{class:"edit-main-wp"},{default:et((()=>[x(c),x(r),x(b,{class:"edit-main"},{default:et((()=>[x(d),x(f,{spinning:e.loading},{default:et((()=>[x(u)])),_:1},8,["spinning"]),x(h)])),_:1}),x(g)])),_:1})])),_:1}),x(y)],64)}));Ze.render=tt,Ze.__scopeId="data-v-729e6e28";var ot=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:Ze});export{X as c,ot as i,K as l,ke as u};
