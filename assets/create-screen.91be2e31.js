import{m as e,r as a,a6 as l,a4 as t,n as i,y as s,B as o,C as n,u as r,v as c,D as d,F as p,E as u,x as m,G as v,X as g}from"./editor.worker.0b81cf4b.js";import{c as f}from"./images.a8ceee1d.js";import{P as w}from"./project.ec6ffcb1.js";import{k as b,g as k,M as C,l as y}from"./index.1ace366a.js";const h=window.requestAnimationFrame||(e=>setTimeout(e,16));function V(e,a={}){const{getContainer:l=(()=>window),callback:t,duration:i=450}=a,s=l(),o=function(e,a){if("undefined"==typeof window)return 0;const l=a?"scrollTop":"scrollLeft",t=e===window;let i=t?e[a?"pageYOffset":"pageXOffset"]:e[l];return t&&"number"!=typeof i&&(i=window.document.documentElement[l]),i}(s,!1),n=Date.now(),r=()=>{const a=Date.now()-n,l=function(e,a,l,t){const i=l-a;return(e/=t/2)<1?i/2*e*e*e+a:i/2*((e-=2)*e*e+2)+a}(a>i?i:a,o,e,i);s===window?window.scrollTo(l,window.pageYOffset):s.scrollLeft=l,a<i?h(r):"function"==typeof t&&t()};h(r)}var _=e({name:"CreateScreen",setup(){const e=a(!0),s=a(f),o=a([]),n=a(!1),r=a(!1),c=a(""),d=a({}),p=a(0),u=a([new w(0,"未分组")]),m=a(!1),v=l(),g=a(null);t((async()=>{const a=await b();0===a.data.code&&(e.value=!1,o.value=a.data.data),k().then((({data:e})=>{0===e.code&&u.value.push(...e.data.map((({id:e,name:a})=>({id:e,name:a}))))}))}));const h=(e,a)=>{d.value=e,V(149*a-350,{getContainer:()=>g.value})};return{loading:e,bgCoverImg:s,templates:o,visibleCreateDialog:n,visiblePreviewDialog:r,projectName:c,template:d,groupId:p,groups:u,saveLoading:m,scrollRef:g,confirmCreate:e=>{d.value=e,n.value=!0},previewTemplate:(e,a)=>{d.value=e,r.value=!0,i((()=>{h(e,a)}))},togglePreviewTemplate:h,prevPreviewTemplate:()=>{const e=o.value.findIndex((e=>e.id===d.value.id));if(e>0){const a=e-1,l=o.value[a];h(l,a)}},nextPreviewTemplate:()=>{const e=o.value.findIndex((e=>e.id===d.value.id));if(e<o.value.length-1){const a=e+1,l=o.value[a];h(l,a)}},doCreate:async()=>{try{if(!c.value)return void C.error("请输入大屏名称");m.value=!0;const e=await y({name:c.value,groupId:p.value,templateId:d.value.id});if(0!==e.data.code)throw Error(e.data.message);n.value=!1,r.value=!1,v.push({name:"Screen",params:{projectId:e.data.data}})}catch(e){C.error(C.format(e))}finally{m.value=!1}}}}});const x=v();s("data-v-8ba19140");const T={class:"create-screen"},I={class:"top-bar"},P=d("div",{class:"right-bar"},null,-1),j=d("div",{class:"left-bar"},null,-1),D=d("span",{class:"return-text"},[d("i",{class:"v-icon-back return-icon"}),g(" 取消创建 ")],-1),U={class:"creator-wp"},z={class:"template-list"},L={class:"template-item --blank"},N={class:"template-image"},q=g(" 创建项目 "),E=d("div",{class:"template-info"}," 空白画板 ",-1),O={class:"template-image"},F={class:"template-mask"},R=g(" 创建项目 "),S=g(" 预览 "),X={class:"template-info"},Y={class:"template-name"},A={class:"template-size"},B={class:"create-dialog"},G=d("p",{class:"name-title"},[d("span",{class:"required"},"*"),g("数据大屏名称 ")],-1),M=d("p",{class:"name-title"},"大屏分组",-1),H=g("取消"),J=g(" 创建 "),K={class:"preview-dialog"},Q={class:"preview-list"},W=d("p",{class:"template-list-title"},"模板列表",-1),Z={class:"blur-wp"},$={ref:"scrollRef",class:"scroll-wp"},ee={class:"preview-screen-name"},ae={class:"preview-gif"},le={class:"gif-wp"},te={class:"preview-create"},ie={class:"create-dialog"},se=d("p",{class:"name-title"},[d("span",{class:"required"},"*"),g("数据大屏名称 ")],-1),oe=d("p",{class:"name-title"},"大屏分组",-1),ne=g(" 创建大屏 "),re=d("i",{class:"el-icon-arrow-right"},null,-1);o();const ce=x(((e,a,l,t,i,s)=>{const o=n("router-link"),v=n("el-button"),g=n("g-loading"),f=n("g-input"),w=n("el-option"),b=n("el-select"),k=n("el-dialog");return r(),c(p,null,[d(g,{type:"square",spinning:e.loading},{default:x((()=>[d("div",T,[d("div",I,[P,j,d(o,{to:"/",class:"return-btn"},{default:x((()=>[D])),_:1})]),d("div",U,[d("div",z,[d("div",L,[d("div",N,[d(v,{type:"primary",icon:"el-icon-plus",onClick:a[1]||(a[1]=a=>e.confirmCreate(null))},{default:x((()=>[q])),_:1})]),E]),(r(!0),c(p,null,u(e.templates,((a,l)=>(r(),c("div",{key:a.id,class:"template-item"},[d("div",O,[d("img",{src:a.thumbnail,alt:"",class:"preview-image"},null,8,["src"]),d("div",F,[d(v,{type:"primary",class:"create-btn",onClick:l=>e.confirmCreate(a)},{default:x((()=>[R])),_:2},1032,["onClick"]),d(v,{class:"preview-btn",onClick:t=>e.previewTemplate(a,l)},{default:x((()=>[S])),_:2},1032,["onClick"])])]),d("div",X,[d("div",Y,m(a.name),1),d("div",A,[(r(!0),c(p,null,u(a.size,((e,a)=>(r(),c("p",{key:a},m(e),1)))),128))])])])))),128)),(r(),c(p,null,u(3,(e=>d("div",{key:e,class:"template-item-placehoder"}))),64))])])])])),_:1},8,["spinning"]),d(k,{modelValue:e.visibleCreateDialog,"onUpdate:modelValue":a[5]||(a[5]=a=>e.visibleCreateDialog=a),title:"创建数据大屏",width:"400px"},{footer:x((()=>[d(v,{onClick:a[4]||(a[4]=a=>e.visibleCreateDialog=!1)},{default:x((()=>[H])),_:1}),d(v,{type:"primary",loading:e.saveLoading,onClick:e.doCreate},{default:x((()=>[J])),_:1},8,["loading","onClick"])])),default:x((()=>[d("div",B,[G,d(f,{modelValue:e.projectName,"onUpdate:modelValue":a[2]||(a[2]=a=>e.projectName=a),placeholder:"请输入大屏名称",spellcheck:"false",class:"name-input"},null,8,["modelValue"]),M,d(b,{modelValue:e.groupId,"onUpdate:modelValue":a[3]||(a[3]=a=>e.groupId=a),size:"mini",placeholder:"请选择"},{default:x((()=>[(r(!0),c(p,null,u(e.groups,(e=>(r(),c(w,{key:e.id,label:e.name,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])])),_:1},8,["modelValue"]),d(k,{modelValue:e.visiblePreviewDialog,"onUpdate:modelValue":a[10]||(a[10]=a=>e.visiblePreviewDialog=a),title:"预览",width:"897px"},{default:x((()=>[d("div",K,[d("div",Q,[W,d("div",Z,[d("div",$,[(r(!0),c(p,null,u(e.templates,((a,l)=>(r(),c("div",{key:a.id,class:["preview-wp",{selected:a.id===e.template.id}],onClick:t=>e.togglePreviewTemplate(a,l)},[d("img",{src:a.thumbnail,class:"preview-small-img"},null,8,["src"]),d("div",ee,m(a.name),1)],10,["onClick"])))),128))],512)])]),d("div",ae,[d("div",le,[d("img",{class:"snapshot-gif",src:e.template.snapshot},null,8,["src"]),d("i",{class:"el-icon-arrow-left prev-icon",onClick:a[6]||(a[6]=(...a)=>e.prevPreviewTemplate&&e.prevPreviewTemplate(...a))}),d("i",{class:"el-icon-arrow-right next-icon",onClick:a[7]||(a[7]=(...a)=>e.nextPreviewTemplate&&e.nextPreviewTemplate(...a))})]),d("div",te,[d("div",ie,[se,d(f,{modelValue:e.projectName,"onUpdate:modelValue":a[8]||(a[8]=a=>e.projectName=a),placeholder:"请输入大屏名称",spellcheck:"false",class:"name-input"},null,8,["modelValue"]),oe,d(b,{modelValue:e.groupId,"onUpdate:modelValue":a[9]||(a[9]=a=>e.groupId=a),size:"mini",placeholder:"请选择"},{default:x((()=>[(r(!0),c(p,null,u(e.groups,(e=>(r(),c(w,{key:e.id,label:e.name,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])]),d(v,{type:"primary",size:"mini",loading:e.saveLoading,style:{"margin-top":"30px"},onClick:e.doCreate},{default:x((()=>[ne,re])),_:1},8,["loading","onClick"])])])])])),_:1},8,["modelValue"])],64)}));_.render=ce,_.__scopeId="data-v-8ba19140";export default _;
