import{b as B,c as F,r as $,t as T,h as k,v as A}from"./App.7d9600e2.js";import{a4 as D,a8 as I,ab as a,a2 as U,a$ as M,a7 as n,aF as P,aA as g,a3 as u,a5 as V,b0 as i,aY as r,ae as C,b1 as b,n as S,bb as j,bc as z}from"./vendor.577170a9.js";const N={},H={t:"1630857633703",class:"icon",viewBox:"0 0 1088 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"3929",width:"64",height:"64"},q=a("path",{d:"M962 788H116C68 788 32 752 32 704V134C32 92 68 50 116 50h846c48 0 84 36 84 84v564c0 48-36 90-84 90zM116 110c-18 0-30 12-30 30v564c0 18 12 30 30 30h846c18 0 30-12 30-30V134c0-18-12-30-30-30H116z","p-id":"3930"},null,-1),L=a("path",{d:"M542 980c-18 0-30-12-30-24v-168c0-12 12-24 30-24s30 12 30 24v168c-6 18-18 24-30 24z","p-id":"3931"},null,-1),O=a("path",{d:"M710 980H368c-18 0-30-12-30-30s12-30 30-30h336c18 0 30 12 30 30s-6 30-24 30zM848 560c-6 0-18-6-24-12l-150-198-156 198c-6 6-12 12-24 12-6 0-18 0-24-6l-120-114-102 108c-6 12-24 12-36 6-12-12-12-30-6-42l120-132c6-6 12-6 18-12 6 0 12 0 18 6l120 114 168-204c6-6 12-12 24-12 6 0 18 6 24 12L872 512c12 12 6 30-6 42-6 6-12 6-18 6z","p-id":"3932"},null,-1),Y=[q,L,O];function G(s,o){return D(),I("svg",H,Y)}var ds=B(N,[["render",G]]);const J=U({name:"PublishScreen",props:{projectId:{type:Number,required:!0},modelValue:{type:Boolean,required:!0}},emits:[F],setup(s,o){const d=M(),c=n(!1),l=n(!1),E=n(!1),p=n(""),_=n("password"),t=n(!0),h=P(()=>l.value?$(s.projectId):""),w=()=>{l.value&&S(()=>{k(h.value)&&d.success("\u590D\u5236\u6210\u529F")})},v=()=>{c.value=!1,o.emit(F,!1)};return g(()=>s.modelValue,e=>{e?c.value=!0:c.value=!1}),g(()=>s.projectId,async()=>{try{const e=await T(s.projectId);if(e.data.code===0){const{data:f}=e.data;t.value=!1,l.value=!!f.share,p.value=f.password}}catch{d.error("\u8BFB\u53D6\u5927\u5C4F\u53D1\u5E03\u4FE1\u606F\u5931\u8D25")}}),{visible:c,isPublish:l,shareUrl:h,showTooltip:E,password:p,copyUrl:w,closeDialog:v,loading:t,passwordType:_,publish:async()=>{try{t.value=!0;const e={share:h.value,password:p.value};(await A(s.projectId,e)).data.code===0&&(t.value=!1,v(),d.success(l.value?"\u53D1\u5E03\u6210\u529F":"\u4FDD\u5B58\u6210\u529F"))}catch{d.error("\u53D1\u5E03\u5931\u8D25")}finally{t.value=!1}}}}}),m=s=>(j("data-v-71cc8724"),s=s(),z(),s),K={class:"share-header"},Q={class:"header-wp"},R=m(()=>a("label",{class:"label-color"},"\u53D1\u5E03\u5206\u4EAB\uFF1A",-1)),W={class:"share-switch"},X={class:"share-tutorial"},Z=b(" \u67E5\u770B\u6559\u7A0B "),x={class:"share-verify"},ss=m(()=>a("div",{class:"label-color"},"\u5206\u4EAB\u94FE\u63A5",-1)),es={class:"link-content"},os=["value"],as=b(" \u70B9\u51FB\u590D\u5236 "),ts=m(()=>a("div",{class:"label-color"},"\u8BBF\u95EE\u5BC6\u7801",-1)),us={class:"share-pwd"},ls={class:"initial-dialog"};function ns(s,o,d,c,l,E){const p=u("n-switch"),_=u("router-link"),t=u("n-tooltip"),h=u("new-input"),w=u("n-button"),v=u("n-spin"),y=u("n-modal");return D(),V(y,{show:s.visible,"onUpdate:show":o[8]||(o[8]=e=>s.visible=e),preset:"dialog","show-icon":!1,title:"\u53D1\u5E03",style:{width:"435px"},onClose:s.closeDialog},{default:i(()=>[r(v,{show:s.loading,class:"share-setting"},{default:i(()=>[a("div",K,[a("div",Q,[R,a("div",W,[r(p,{value:s.isPublish,"onUpdate:value":o[0]||(o[0]=e=>s.isPublish=e)},null,8,["value"])])]),a("div",X,[r(_,{to:{name:"MyCase"},class:"share-tutorial-url",target:"_blank"},{default:i(()=>[Z]),_:1})])]),a("div",x,[ss,a("div",es,[r(t,{show:s.showTooltip,trigger:"manual",disabled:!s.isPublish},{trigger:i(()=>[a("textarea",{value:s.shareUrl,class:"new-input share-input",readonly:"",placeholder:"\u5F00\u542F\u53D1\u5E03\u5206\u4EAB\u540E\u53EF\u83B7\u53D6\u8BBF\u95EE\u94FE\u63A5",onClick:o[1]||(o[1]=(...e)=>s.copyUrl&&s.copyUrl(...e)),onMouseenter:o[2]||(o[2]=e=>s.showTooltip=!0),onMouseleave:o[3]||(o[3]=e=>s.showTooltip=!1)},null,40,os)]),default:i(()=>[as]),_:1},8,["show","disabled"]),a("div",{class:"func-btn",onClick:o[4]||(o[4]=(...e)=>s.copyUrl&&s.copyUrl(...e))},"\u590D\u5236")]),ts,a("div",us,[r(h,{modelValue:s.password,"onUpdate:modelValue":o[5]||(o[5]=e=>s.password=e),type:s.passwordType,placeholder:"\u8BBE\u7F6E\u8BBF\u95EE\u5BC6\u7801",class:"pwd-input"},null,8,["modelValue","type"]),a("div",{class:"func-btn",onClick:o[6]||(o[6]=e=>s.passwordType?s.passwordType="":s.passwordType="password")},C(s.passwordType?"\u67E5\u770B":"\u9690\u85CF"),1),a("div",{class:"func-btn",onClick:o[7]||(o[7]=e=>s.password="")}," \u6E05\u7A7A ")])]),a("div",ls,[r(w,{type:"primary",focusable:!1,class:"publish-btn",onClick:s.publish},{default:i(()=>[b(C(s.isPublish?"\u53D1\u5E03\u5927\u5C4F":"\u4FDD\u5B58"),1)]),_:1},8,["onClick"])])]),_:1},8,["show"])]),_:1},8,["show","onClose"])}var cs=B(J,[["render",ns],["__scopeId","data-v-71cc8724"]]);export{ds as I,cs as P};
