(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["create-screen"],{1095:function(e,t,n){"use strict";n.r(t);var c=n("7a23"),r=Object(c["withScopeId"])("data-v-c1bf1562");Object(c["pushScopeId"])("data-v-c1bf1562");var a={class:"create-screen"},o={class:"top-bar"},l=Object(c["createVNode"])("div",{class:"right-bar"},null,-1),i=Object(c["createVNode"])("div",{class:"left-bar"},null,-1),u=Object(c["createVNode"])("span",{class:"return-text"},[Object(c["createVNode"])("i",{class:"v-icon-back return-icon"}),Object(c["createTextVNode"])(" 取消创建 ")],-1),d={class:"creator-wp"},s={class:"template-list"},p={class:"template-item --blank"},b={class:"template-image"},f=Object(c["createTextVNode"])(" 创建项目 "),j=Object(c["createVNode"])("div",{class:"template-info"}," 空白画板 ",-1),v={class:"template-image"},m={class:"template-mask"},O=Object(c["createTextVNode"])(" 创建项目 "),g=Object(c["createTextVNode"])(" 预览 "),V={class:"template-info"},N={class:"template-name"},w={class:"template-size"},k={class:"create-dialog"},h=Object(c["createVNode"])("p",{class:"name-title"},[Object(c["createVNode"])("span",{class:"required"},"*"),Object(c["createTextVNode"])("数据大屏名称 ")],-1),C=Object(c["createVNode"])("p",{class:"name-title"},"大屏分组",-1),x=Object(c["createTextVNode"])("取消"),y=Object(c["createTextVNode"])(" 创建 "),B={class:"preview-dialog"},T={class:"preview-list"},I=Object(c["createVNode"])("p",{class:"template-list-title"},"模板列表",-1),_={class:"blur-wp"},D={ref:"scrollRef",class:"scroll-wp"},L={class:"preview-screen-name"},P={class:"preview-gif"},F={class:"gif-wp"},S={class:"preview-create"},U={class:"create-dialog"},z=Object(c["createVNode"])("p",{class:"name-title"},[Object(c["createVNode"])("span",{class:"required"},"*"),Object(c["createTextVNode"])("数据大屏名称 ")],-1),q=Object(c["createVNode"])("p",{class:"name-title"},"大屏分组",-1),E=Object(c["createTextVNode"])(" 创建大屏 "),J=Object(c["createVNode"])("i",{class:"el-icon-arrow-right"},null,-1);Object(c["popScopeId"])();var R=r((function(e,t,n,R,Y,A){var M=Object(c["resolveComponent"])("router-link"),X=Object(c["resolveComponent"])("el-button"),G=Object(c["resolveComponent"])("g-loading"),H=Object(c["resolveComponent"])("g-input"),K=Object(c["resolveComponent"])("el-option"),Q=Object(c["resolveComponent"])("el-select"),W=Object(c["resolveComponent"])("el-dialog");return Object(c["openBlock"])(),Object(c["createBlock"])(c["Fragment"],null,[Object(c["createVNode"])(G,{type:"square",spinning:e.loading},{default:r((function(){return[Object(c["createVNode"])("div",a,[Object(c["createVNode"])("div",o,[l,i,Object(c["createVNode"])(M,{to:"/",class:"return-btn"},{default:r((function(){return[u]})),_:1})]),Object(c["createVNode"])("div",d,[Object(c["createVNode"])("div",s,[Object(c["createVNode"])("div",p,[Object(c["createVNode"])("div",b,[Object(c["createVNode"])(X,{type:"primary",icon:"el-icon-plus",onClick:t[1]||(t[1]=function(t){return e.confirmCreate(0)})},{default:r((function(){return[f]})),_:1})]),j]),(Object(c["openBlock"])(!0),Object(c["createBlock"])(c["Fragment"],null,Object(c["renderList"])(e.templates,(function(t,n){return Object(c["openBlock"])(),Object(c["createBlock"])("div",{key:t.id,class:"template-item"},[Object(c["createVNode"])("div",v,[Object(c["createVNode"])("img",{src:t.thumbnail,alt:"",class:"preview-image"},null,8,["src"]),Object(c["createVNode"])("div",m,[Object(c["createVNode"])(X,{type:"primary",class:"create-btn",onClick:function(n){return e.confirmCreate(t)}},{default:r((function(){return[O]})),_:2},1032,["onClick"]),Object(c["createVNode"])(X,{class:"preview-btn",onClick:function(c){return e.previewTemplate(t,n)}},{default:r((function(){return[g]})),_:2},1032,["onClick"])])]),Object(c["createVNode"])("div",V,[Object(c["createVNode"])("div",N,Object(c["toDisplayString"])(t.name),1),Object(c["createVNode"])("div",w,[(Object(c["openBlock"])(!0),Object(c["createBlock"])(c["Fragment"],null,Object(c["renderList"])(t.size,(function(e,t){return Object(c["openBlock"])(),Object(c["createBlock"])("p",{key:t},Object(c["toDisplayString"])(e),1)})),128))])])])})),128)),(Object(c["openBlock"])(),Object(c["createBlock"])(c["Fragment"],null,Object(c["renderList"])(3,(function(e){return Object(c["createVNode"])("div",{key:e,class:"template-item-placehoder"})})),64))])])])]})),_:1},8,["spinning"]),Object(c["createVNode"])(W,{modelValue:e.visibleCreateDialog,"onUpdate:modelValue":t[5]||(t[5]=function(t){return e.visibleCreateDialog=t}),title:"创建数据大屏",width:"400px"},{footer:r((function(){return[Object(c["createVNode"])(X,{onClick:t[4]||(t[4]=function(t){return e.visibleCreateDialog=!1})},{default:r((function(){return[x]})),_:1}),Object(c["createVNode"])(X,{type:"primary",loading:e.saveLoading,onClick:e.doCreate},{default:r((function(){return[y]})),_:1},8,["loading","onClick"])]})),default:r((function(){return[Object(c["createVNode"])("div",k,[h,Object(c["createVNode"])(H,{modelValue:e.projectName,"onUpdate:modelValue":t[2]||(t[2]=function(t){return e.projectName=t}),placeholder:"请输入大屏名称",spellcheck:"false",class:"name-input"},null,8,["modelValue"]),C,Object(c["createVNode"])(Q,{modelValue:e.groupId,"onUpdate:modelValue":t[3]||(t[3]=function(t){return e.groupId=t}),size:"mini",placeholder:"请选择"},{default:r((function(){return[(Object(c["openBlock"])(!0),Object(c["createBlock"])(c["Fragment"],null,Object(c["renderList"])(e.groups,(function(e){return Object(c["openBlock"])(),Object(c["createBlock"])(K,{key:e.id,label:e.name,value:e.id},null,8,["label","value"])})),128))]})),_:1},8,["modelValue"])])]})),_:1},8,["modelValue"]),Object(c["createVNode"])(W,{modelValue:e.visiblePreviewDialog,"onUpdate:modelValue":t[10]||(t[10]=function(t){return e.visiblePreviewDialog=t}),title:"预览",width:"897px"},{default:r((function(){return[Object(c["createVNode"])("div",B,[Object(c["createVNode"])("div",T,[I,Object(c["createVNode"])("div",_,[Object(c["createVNode"])("div",D,[(Object(c["openBlock"])(!0),Object(c["createBlock"])(c["Fragment"],null,Object(c["renderList"])(e.templates,(function(t,n){return Object(c["openBlock"])(),Object(c["createBlock"])("div",{key:t.id,class:["preview-wp",{selected:t.id===e.template.id}],onClick:function(c){return e.togglePreviewTemplate(t,n)}},[Object(c["createVNode"])("img",{src:t.thumbnail,class:"preview-small-img"},null,8,["src"]),Object(c["createVNode"])("div",L,Object(c["toDisplayString"])(t.name),1)],10,["onClick"])})),128))],512)])]),Object(c["createVNode"])("div",P,[Object(c["createVNode"])("div",F,[Object(c["createVNode"])("img",{class:"snapshot-gif",src:e.template.snapshot},null,8,["src"]),Object(c["createVNode"])("i",{class:"el-icon-arrow-left prev-icon",onClick:t[6]||(t[6]=function(){return e.prevPreviewTemplate&&e.prevPreviewTemplate.apply(e,arguments)})}),Object(c["createVNode"])("i",{class:"el-icon-arrow-right next-icon",onClick:t[7]||(t[7]=function(){return e.nextPreviewTemplate&&e.nextPreviewTemplate.apply(e,arguments)})})]),Object(c["createVNode"])("div",S,[Object(c["createVNode"])("div",U,[z,Object(c["createVNode"])(H,{modelValue:e.projectName,"onUpdate:modelValue":t[8]||(t[8]=function(t){return e.projectName=t}),placeholder:"请输入大屏名称",spellcheck:"false",class:"name-input"},null,8,["modelValue"]),q,Object(c["createVNode"])(Q,{modelValue:e.groupId,"onUpdate:modelValue":t[9]||(t[9]=function(t){return e.groupId=t}),size:"mini",placeholder:"请选择"},{default:r((function(){return[(Object(c["openBlock"])(!0),Object(c["createBlock"])(c["Fragment"],null,Object(c["renderList"])(e.groups,(function(e){return Object(c["openBlock"])(),Object(c["createBlock"])(K,{key:e.id,label:e.name,value:e.id},null,8,["label","value"])})),128))]})),_:1},8,["modelValue"])]),Object(c["createVNode"])(X,{type:"primary",size:"mini",loading:e.saveLoading,style:{"margin-top":"30px"},onClick:e.doCreate},{default:r((function(){return[E,J]})),_:1},8,["loading","onClick"])])])])]})),_:1},8,["modelValue"])],64)})),Y=n("c973"),A=n.n(Y),M=n("a34a"),X=n.n(M),G=n("6c02"),H=n("b641"),K=n("9495"),Q=n("6ca5"),W=n("99c2");function Z(e,t){if("undefined"===typeof window)return 0;var n=t?"pageYOffset":"pageXOffset",c=t?"scrollTop":"scrollLeft",r=e===window,a=r?e[n]:e[c];return r&&"number"!==typeof a&&(a=window.document.documentElement[c]),a}var $=window.requestAnimationFrame||function(e){return setTimeout(e,16)};function ee(e,t,n,c){var r=n-t;return e/=c/2,e<1?r/2*e*e*e+t:r/2*((e-=2)*e*e+2)+t}function te(e,t){void 0===t&&(t={});var n=t,c=n.getContainer,r=void 0===c?function(){return window}:c,a=n.callback,o=n.duration,l=void 0===o?450:o,i=r(),u=Z(i,!1),d=Date.now(),s=function t(){var n=Date.now(),c=n-d,r=ee(c>l?l:c,u,e,l);i===window?window.scrollTo(r,window.pageYOffset):i.scrollLeft=r,c<l?$(t):"function"===typeof a&&a()};$(s)}var ne=Object(c["defineComponent"])({name:"CreateScreen",setup:function(){var e=Object(c["ref"])(!0),t=Object(c["ref"])(H["c"]),n=Object(c["ref"])([]),r=Object(c["ref"])(!1),a=Object(c["ref"])(!1),o=Object(c["ref"])(""),l=Object(c["ref"])({}),i=Object(c["ref"])(0),u=Object(c["ref"])([new K["a"](0,"未分组")]),d=Object(c["ref"])(!1),s=Object(G["d"])(),p=Object(c["ref"])(null);Object(c["onMounted"])(A()(X.a.mark((function t(){var c;return X.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(Q["g"])();case 2:c=t.sent,0===c.data.code&&(e.value=!1,n.value=c.data.data),Object(Q["h"])().then((function(e){var t,n=e.data;0===n.code&&(t=u.value).push.apply(t,n.data.map((function(e){var t=e.id,n=e.name;return{id:t,name:n}})))}));case 5:case"end":return t.stop()}}),t)}))));var b=function(e){l.value=e,r.value=!0},f=function(e,t){l.value=e,a.value=!0,Object(c["nextTick"])((function(){j(e,t)}))},j=function(e,t){l.value=e,te(149*t-350,{getContainer:function(){return p.value}})},v=function(){var e=n.value.findIndex((function(e){return e.id===l.value.id}));if(e>0){var t=e-1,c=n.value[t];j(c,t)}},m=function(){var e=n.value.findIndex((function(e){return e.id===l.value.id}));if(e<n.value.length-1){var t=e+1,c=n.value[t];j(c,t)}},O=function(){var e=A()(X.a.mark((function e(){var t;return X.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(e.prev=0,o.value){e.next=4;break}return W["b"].error("请输入大屏名称"),e.abrupt("return");case 4:return d.value=!0,e.next=7,Object(Q["b"])({name:o.value,groupId:i.value,templateId:l.value.id});case 7:if(t=e.sent,0!==t.data.code){e.next=14;break}r.value=!1,a.value=!1,s.push({name:"Screen",params:{projectId:t.data.data}}),e.next=15;break;case 14:throw Error(t.data.message);case 15:e.next=20;break;case 17:e.prev=17,e.t0=e["catch"](0),W["b"].error(W["b"].format(e.t0));case 20:return e.prev=20,d.value=!1,e.finish(20);case 23:case"end":return e.stop()}}),e,null,[[0,17,20,23]])})));return function(){return e.apply(this,arguments)}}();return{loading:e,bgCoverImg:t,templates:n,visibleCreateDialog:r,visiblePreviewDialog:a,projectName:o,template:l,groupId:i,groups:u,saveLoading:d,scrollRef:p,confirmCreate:b,previewTemplate:f,togglePreviewTemplate:j,prevPreviewTemplate:v,nextPreviewTemplate:m,doCreate:O}}});n("f69b");ne.render=R,ne.__scopeId="data-v-c1bf1562";t["default"]=ne},"5cc0":function(e,t,n){},"6ca5":function(e,t,n){"use strict";n.d(t,"h",(function(){return r})),n.d(t,"f",(function(){return a})),n.d(t,"b",(function(){return o})),n.d(t,"n",(function(){return l})),n.d(t,"d",(function(){return i})),n.d(t,"k",(function(){return u})),n.d(t,"a",(function(){return d})),n.d(t,"c",(function(){return s})),n.d(t,"e",(function(){return p})),n.d(t,"m",(function(){return b})),n.d(t,"g",(function(){return f})),n.d(t,"i",(function(){return j})),n.d(t,"l",(function(){return v})),n.d(t,"j",(function(){return m}));var c=n("b32d");function r(){return c["a"].get("/project")}function a(e){return c["a"].get("/project/"+e)}function o(e){return c["a"].post("/project",e)}function l(e,t){return c["a"].put("/project/"+e+"/name",{name:t})}function i(e){return c["a"].delete("/project/"+e)}function u(e,t,n){return c["a"].put("/project/"+e+"/group",{fromId:t,toId:n})}function d(e){return c["a"].post("/project/"+e+"/copy")}function s(e){return c["a"].post("/project/group",e)}function p(e){return c["a"].delete("/project/group/"+e)}function b(e,t){return c["a"].put("/project/group/"+e+"/name",{name:t})}function f(){return c["a"].get("/project/template")}function j(e){return c["a"].get("/project/"+e+"/publish")}function v(e,t){return c["a"].post("/project/"+e+"/publish",t)}function m(e){return window.location.origin+"/screen/"+e}},9495:function(e,t,n){"use strict";var c;n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return r})),function(e){e[e["ungroup"]=0]="ungroup",e[e["group"]=1]="group"}(c||(c={}));var r=function(e,t,n){void 0===e&&(e=0),void 0===t&&(t=""),void 0===n&&(n=[]),this.id=e,this.name=t,this.children=n,this.type=c.ungroup}},f69b:function(e,t,n){"use strict";n("5cc0")}}]);
//# sourceMappingURL=create-screen.bc1edceb.js.map